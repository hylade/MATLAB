##初等模型

### 光盘的数据容量

CD 的数据容量：单层 650 MB

DVD 的数据容量：单层 4.7 GB

==从数学建模的角度研究：光盘的数据容量是怎么确定的，在一定条件下怎样使其最大化==

怎样存储？经过编码的数字信息，以一定深度和宽度、不同长度的凹坑的形式，用烧蚀技术存储在光盘表面呈螺旋线形状的信道上；信道需要有信道间距

当光盘上环形区域面积一定时，数据容量的大小取决于信道的==总长度==与信道上存储数据的==线密度（即单位长度上存储信息量）==

决定信道长度（考虑信道间距）和线密度大小的主要因素是所用==激光的波长和驱动光盘的机械形式==

$$激光波长、驱动形式 \to信道长度、线密度\to数据容量$$:kissing_smiling_eyes:



#### 激光波长

1. 当光盘运转时，激光束要能识别出信道上的凹坑所携带的信息，必须精确地聚焦
2. 光的衍射使激光束在光盘上形成圆形的光斑（说明在读取信息时，光点并不是数学上所说的没有大小的点，而是具有一定直径的圆）
3. 为了提高存储数据的线密度，应该使光斑尽量小，而光斑的大小与激光波长成正比（激光波长越长，光斑越大），故为了增加存储量，应该使用波长较小的激光

|   激光器    | 激光波长（$\mu$m） | 光斑直径（$\mu$m） | 信道间距（$\mu$m） | 数据线密度（字节/mm） |
| :---------: | :----------------: | :----------------: | :----------------: | :-------------------: |
| 红外（CD）  |        0.78        |         2          |        1.6         |          121          |
| 红外（DVD） |        0.64        |       0.925        |        0.74        |          387          |
| 蓝色（DVD） |        0.41        |        0.4         |        0.32        |          800          |



#### 驱动光盘的机械形式

恒定角速度（CAV）或者恒定线速度（CLV）

当为恒定角速度时，每一圈螺旋线上存储同等数量的数据信息；容量取决于最内圈的长度、线密度以及总圈数

当为恒定线速度时，各圈螺旋线上数据的线密度不变；容量取决于固定的线密度和螺旋线总长度；

但从容量角度将，CLV 方式应该优于 CAV 方式；同时为了保证线速度相等， CLV 每圈转速不同，当读出磁头在内外圈移动时，需要等待光盘加速和减速而 CAV 不需要，故两者读取时间不同



#### 应用

对音乐、影像、计算机文件等按顺序播放的信息，多用 CLV；

对词典、数据库、人机交互等常要随机查找的信息，多用 CAV（为了保证查找精度和速度）



#### 模型建立

对于 CLV 光盘，数据容量 $C_{CLV} = \rho L_{CLV}$ ，式中 $\rho$ 为线密度， $L_{CLV}$ 为信道总长度

由于信道为螺旋线，其长度求解较为困难，在此简化为同心圆进行求解

$$L_{CLV} \approx \sum \limits_{k = 0}^{n-1}2\pi(R_1+kd)=\frac{\pi(R_2-R_1)(R_2+R_1-d)}{d}$$ 

==其他方法==

通过面积除以信道间距求得长度 $L_{CLV} \approx \frac{\pi(R_2^2-R_1^2)}{d}$

通过同心圆平均周长 * 总圈数 $L_{CLV} = 2\pi \frac{R_2+R_1}{2}\frac{R_2-R_1}{d}$



对于 CAV 光盘，数据容量 $C_{CAV} = \rho L_{CAV}$ ，式中 $\rho$ 为线密度， $L_{CAV}$ 为信道总长度

螺旋线最内圈的长度近似为 $2\pi R_1$ ，总圈数可视为 $\frac{R_2-R_1}{d}$

由于只能按照最内圈的线密度和信道长度计算，故 $L_{CAV} =2\pi R_1 \frac{R_2-R_1}{d}$

当给定线密度 $\rho$ ，信道间距 $d$ 和外径 $R_2$ 后，可选择环形区域的内圈半径 $R_1$ ，使数据容量最大



#### 分析

对于 CLV 光盘，将 $L_{CLV}$ 简化为 $L_{CLV} \approx \frac{\pi(R_2^2-R_1^2)}{d}$

并根据一般光盘的大小， $R_2 = 58mm,R_1=22.5mm$ ，可知（影像时间按每秒钟占用 0.62 MB计算）

|   激光器    | 激光波长（$\mu$m） | 信道长度（mm） | 信息容量（MB） | 影像时间（min） |
| :---------: | :----------------: | :------------: | :------------: | :-------------: |
| 红外（CD）  |        0.78        |   5,611,179    |      679       |       18        |
| 红外（DVD） |        0.64        |   12,132,279   |     4,695      |       126       |
| 蓝色（DVD） |        0.41        |   28,055,895   |     22,445     |       603       |

对于 CLV 光盘，不存在最大值，只要信道足够长，那么存储量将一直增加



对于恒定角速度光盘，由于 $L_{CAV} =2\pi R_1 \frac{R_2-R_1}{d}$ ，当 $R_1=R_2/2$ 时，可使 $L_{CAV}$ 达到最大值，此时为 $\frac{\pi R_2^2}{2d}$

此时，光盘的存储信息等为

|   激光器    | 激光波长（m） | 信道长度（mm） | 信息容量（MB） | 影像时间（min） |
| :---------: | :-----------: | :------------: | :------------: | :-------------: |
| 红外（CD）  |     0.78      |   3,302,599    |      400       |       11        |
| 红外（DVD） |     0.64      |   7,140,755    |     2,764      |       74        |
| 蓝色（DVD） |     0.41      |   16,512,996   |     13,210     |       355       |

但即使内圆半径为最佳选择， CAV 光盘的信息容量也小于 CLV 光盘



### 核军备竞赛

求解在什么情况下双方的核军备竞赛不会无限扩张，而存在暂时的平衡状态；同时估计平衡状态下双方拥有的最少的核武器数量，这个数量受哪些因素影响；当一方采取加强防御、提高武器精度、发展多弹头导弹等措施时，平衡状态将发生什么变化



#### 模型假设

以双方（战略）核导弹数量描述核军备的大小

假定双方采用如下同样的==核威慑战略==：

1. 认为对方可能发起所谓第一次核打击，即倾其全部核导弹攻击己方的核导弹基地
2. 己方在经受第一次核打击后，应保存足够的核导弹，给对方重要目标以毁灭性打击
3. 在任一方实施第一次核打击时，假定一枚核导弹只能攻击对方的一个核导弹基地（认为一个基地只存有核导弹）
4. 摧毁这个基地的可能性是常数，它由一方的攻击精度和另一方的防御能力决定



#### 图的模型

设 y = f(x) ，表示甲有 x 枚导弹，乙所需要的最少导弹数（乙安全线）

设 x = f(y) ，表示乙有 y 枚导弹，甲所需要的最少导弹数（甲安全线）（这两条线应互为反函数，以 y = x 为对称轴对称）

当 x = 0 时，y = y0 ，此时 y0 表示为乙方的威慑值，即当甲方实行第一次打击后已经没有导弹或者原本就没有导弹时，乙方为摧毁甲方工业、交通中心等目标所需导弹数目

故可知 y = f(x) 应大于 y0 ，同时，由于每次导弹打击并不能都能命中，故 y = f(x) 应小于 y0 + x

由此可大致绘出 y = f(x) 的线条，再根据对称轴 y = x ，绘制出 x = g(y) 的线条；由于 y = f(x) 上侧是乙方的安全区， x = g(y) 下侧是甲方的安全区，故两条线应有交点 P(Xm, Ym) ，此为平衡点，此时的双方的导弹数目最少



### 分析模型

假定乙方残存率为 s ：表示甲方一枚导弹攻击乙方一个基地，基地未被摧毁的概率

当 x < y ：甲方以 x 枚导弹攻击乙方 y 个基地中的 x 个，此时 sx 个基地未被摧毁， y-x 个基地未被攻击

故： $y_0 = sx + y-x$ ，得 $y = y_0 + (1-s)x$

当 x = y ：将上式化简得 $y_0=sy$ ， $y = y_0/s$

当 y < x < 2y ：乙方的 x-y 个基地被攻击两次，故 $s^2(x-y)$ 个基地未被摧毁； $y-(x-y)=xy-x$ 个基地被攻击 1 次，故将有 $s(2y-x)$ 个未被摧毁

故： $y_0 = s^(x-y) + s(2y-x)$ ，得 $y = \frac{y_0}{s(2-s)}+\frac{1-s}{2-s}x$

当 x = 2y ：代入上式，得 $y_0 = s^2y$ ，$y = y_0/s^2$



故进行类推：若 x = ay ，那么 $y = \frac{f_0}{s^a} = \frac{y_0}{s^{x/y}}$ ，利用微积分知识可知 y 是一条上凸的曲线，且当 $y_0$ 变大，曲线将上移、变陡；当 s 变大，y 将减小，曲线变平



### 模型解释

若甲方增加经费保护及疏散工业、交通中心等目标

1. 乙方威慑值 $y_0$ 将变大
2. 乙方安全线 y 将上移
3. 平衡点 $P\to P'$ （向右上方移动）
4. $x_m'>x_m , y_m'>y_m$

说明甲方的被动防御也会使双方军备竞赛升级



若甲方将固定核导弹基地改进为可移动发射架

1. 乙方安全线 y 不变，同时甲方残存率变大，威慑值 $x_0$ 不变
2. x 减小，甲方安全线 x = g(x) 向 y 轴靠近
3. 平衡点 $P\to P'$ （向左下方移动）
4. $x_m'<x_m , y_m'<y_m$

说明甲方这种单独行为会使双方的核导弹数目减少



若双方发展多弹头导弹，每个弹头可以独立地摧毁目标（x, y 仍为双方核导弹的数量）

1. 双方威慑值 $x_0$ ， $y_0$ 和残存率 s 均将减小
2. 由于 $y_0$ 减小，将使 y 下移且变平，但 s 变小，将使 y 增加且变陡

所以新的平衡点 P' 会在左下方或是在右上方需要更多信息及更加详细的分析



### 天气预报的评价

| 日期 | 预报A（%） | 预报B（%） | 预报C（%） | 预报D（%） | 实测（有雨=1，无雨=0） |
| :--: | :--------: | :--------: | :--------: | :--------: | :--------------------: |
|  1   |     90     |     30     |     90     |     60     |           1            |
|  2   |     40     |     30     |     50     |     80     |           1            |
|  3   |     10     |     30     |     20     |     10     |           0            |
|  4   |     80     |     30     |     50     |     10     |           0            |



#### 计数模型

认为明天有雨概率 $\geq50\%$ 为预报有雨；

认为明天有雨概率 $\leq50\%$ 为预报无雨；

认为概率 = 50% 时，毫无意义，不予统计



同时从实用角度看，更重要的是误报率，当预报有雨而实测无雨的概率为 P1 时，将造成预防费用浪费；当预报无雨而实测有雨的概率为 P2 时，将造成预防不足导致损失



综上来看，该模型的缺点在于未考虑预报概率的具体数值



####记分模型-模型1

将预报有雨概率与实测结果比较并记分

当实测有雨，且预报有雨概率 > 0.5 时，得到相应的正分；若预报有雨概率 < 0.5 时，得到相应的负分

假定 $p_k$ 为第 k 天预报有雨概率，$v_k = 1$ 表示第 k 天有雨， $v_k =0$ 表示第 k 天无雨

那么第 k 天的预报得分应该为

$$s_k=\begin{cases} p_k-0.5,&v_k=1\\0.5-p_k,&v_k=0\end{cases}$$

对每一天的得分求和得到预报分数 S1 ， S1 越大越好；但仍有缺陷



#### 记分模型-模型2

假定 $p_k$ 为第 k 天预报有雨概率，$v_k = 1$ 表示第 k 天有雨， $v_k =0$ 表示第 k 天无雨

并认为第 k 天的预报得分为 $s_k = |p_k-v_k|$ （由于实测的结果只有 1 和 0 ，对于 $p_k$ 越接近于两端时将越有效），对 k 求和得到预报的分数 S2 ， S2 越小越好



==模型 1 和 2 对 4 种预报的优劣排序、相对方差都是相同的，即等价的（原因在于都是线性评价得分）==



#### 记分模型-模型3

假定第 k 天的预报得分为 $s_k=(p_k-v_k)^2$ 

对 k 求和得到预报的分数 S3 ， S3 越小越好；相较于 模型2 方法，该方法的优点在于，能够使得分更加合理，比如当预报 90% 有雨，实测有雨时，此方法得分为 0.81 ，相较于模型 2 的 0.9 得分小，同时直观感受 90% 的预报也是很准确的，故更好地反应预报得分



#### 对标模型 3 和模型 2 的优劣

若存在理论上的有雨概率 f ，即 P(v=1) = f ， P(v=0) = 1 - f

那么模型 3 的期望分数为

$$E(S) = E[(p-v)^2]=f(p-1)^2+(1-f)p^2 =f(1-f)+(p-f)^2$$

上式当 p = f 时取最小值



由于类似于模型 3 ，指数若为 n 时，得分为 $S=(|p-v|)^n$ ，此时求 E(S) 的极值

仅当 n = 2 时， p = f 才能使 E(S) 最小，此意义下模型 3 最佳



#### 图形模型-模型1

在 xoy 坐标轴上绘制 v = 0 和 v = 1 两条水平线，x 轴上按照概率划分间隔；在两条水平线上按照预报的概率描点，若最终图形在 v = 0 上的点靠近左端， v = 1 上的点靠近右端，那么说明预测结果较优



#### 图形模型-模型2

设 p 为预报有雨的概率， q 为实测有雨天数比例；那么当 p 和 q 接近时说明预测效果好，在 poq 坐标轴上表示为当离对角线接近时，预测效果好

但该模型对于预报 B 方法不能适用（原因在于 B 方法每次预报概率都相同，且等于实测下雨天数与总天数的比值），且由于数据量较小，不能使 D 方法得到正确评价



#### 深入讨论

##### 第一类标准

==预报者本身的一致性==：指预报者根据知识、信息和经验对预报的事件作出的判断，与他对外发布的预报之间的关系

产生不一致的原因： 1. 预报者没有利用全部判断，只从使用者的需要出发； 2. 处于预报效益考虑，对判断作出了改变

##### 第二类标准

==根据预报和实测间的关系，评价预报的品质==

##### 第三类标准

==利用预报所实现的效应或带来的费用==：利用决策分析法估计预报的效益或带来的期望值，与不用预报相比



## 简单的优化模型（静态优化）

静态优化问题指==最优解是数==（不是函数）；建立静态优化模型的关键之一是根据建模目的确定恰当的==目标函数==；求解静态优化模型一般用==微分法==

### 存贮模型（不允许缺货模型）

配件厂为装配线生产若干种产品，轮换产品时因更换设备要付生产准备费，产量大于需求时要付贮存费，该厂生产能力非常大，即所需数量可在很短时间内产出。已知某产品日需求量 100 件，生产准备费 5000 元，贮存费每日每件 1 元，试安排该产品的生产计划，即多少天生产一次（生产周期），每次产量多少，使总费用最小

要求：不只是回答问题，而且要建立生产周期、产量与需求量、准备费、贮存费之间的关系



####问题分析与思考

1. 每天生产一次，每次 100 件，无贮存费，准备费每日 5000 元
2. 10 天生产一次，每次 1000 件，贮存费为 900 + 800 + ... + 100 = 4500 元，准备费 5000 元，总计 9500 元，每天费用 950 元
3. 50 天生产一次，每次 5000 件，贮存费 4900 +4800 + ... 100 = 122500 元，准备费 5000 元，总计 127500 元，每天费用 2550 元

说明，周期短，产量小，贮存费少，但准备费多；周期长，产量大，贮存费多，准备费少；



#### 模型假设

1. 产品每天的需求量为常数 r
2. 每次生产准备费为 c1 ，每天每件产品贮存费为 c2
3. T 天生产一次（周期），每次生产 Q 件，当贮存量为 0 时， Q 件产品立即到来（生产时间不计）
4. 为方便起见，时间和产量都作为连续量处理



#### 建模目的

设 r , c1, c2 已知，求 T ， Q 使每天总费用的平均值最小



#### 模型建立（离散问题连续化）

贮存量表示为时间的函数 q(t) ； t = 0 表示生产 Q 件， q(0) = Q ， q(t) 以需求速率 r 递减， q(T)  = 0

可知： Q = rT

那么一周期贮存费为： $c_2\int _{0}^T q(t)dt = c_2 \frac{QT}{2}$ ， 一周期总费用为 $\tilde{C} = c_1 + c_2\frac{QT}{2} =c_1+c_2\frac{rT^2}{2}$

每天总费用的平均值为： $C(T) = \frac{\tilde{C}}{T} = \frac{c_1}{T}+\frac{c_2rT}{2}$



#### 模型求解

求 T 使  $C(T) = \frac{\tilde{C}}{T} = \frac{c_1}{T}+\frac{c_2rT}{2}$ 	取 min

将上式求导，可知当 $T=\sqrt{\frac{2c_1}{rc_2}}$ 时，C 取 min ，此时 $Q=rT=\sqrt{\frac{2c_1r}{c_2}}$



#### 模型解释

#####定性分析

根据上式及自我理解定性分析：当 $c_1$ 增大时， 说明准备费变大，此时应该增大周期 T ，并且增加产量 Q；当 $c_2$ 增大时，说明贮备费变大，此时应该减小周期 T， 并且减少产量 Q ；当 r 变大时，说明需求量变大，那么产量 Q 应该增加，生产周期 T 变短



##### 敏感性分析

即对参数 $c_1$ ， $c_2$ ， r 的微小变化对 T， Q 的影响

即考虑 T 对 $c_1$ 的（相对）敏感度， $S(T, c_1) = \frac{\Delta T/T}{\Delta c_1/c_1} = \frac{dT}{dc_1}\frac{c_1}{T} = \frac{1}{2}$ ，说明 $c_1$ 增加 1% ， T 增加 0.5%

同理可知 $S(T, c_2)=-1/2$ ， $S(T, r) = -1/2$ ，说明 $c_2$ 或 r 增加 1% ， T将减少 0.5%

说明对 T 敏感性不强，当该模型存在偏差时，仍可进行使用；同样，可以考虑参数对 Q 的敏感性进行分析



#### 模型应用

$T=\sqrt{\frac{2c_1}{rc_2}}$ ， $Q=rT=\sqrt{\frac{2c_1r}{c_2}}$

对于本节开头的问题， $c_1 = 5000$ ， $c_2 = 1$ ，r = 100 ；代入可知 T = 10 天， Q = 1000 件， C = 1000元

可见 C 与前述的日均费用有差别，这是因为本函数将原本离散问题连续化处理的结果

 

### 允许缺货的贮存模型

当贮存量降到零时仍有需求 r ，出现缺货将造成损失（前一个模型假设是当贮存量降到零时， Q 件立即生产出来或立即到货）

现假设：允许缺货，每天每件缺货损失费 c3 ，缺货需要不补足

那么对于周期 T ， $t= T_1$ 时贮存量降到零

一周期的贮存费 $c_2\int_0^{T_1}q(t)dt=c_2A=c_2\frac{QT_1}{2}$

一周期的缺货费 $c_3\int_{T_1}^T|q(t)|dt=c_3B=c_3\frac{r(T-T_1)^2}{2}$

所以一周期的总费用为 $\overline{C} = c_1+c_2\frac{QT}{2}+c_3\frac{r(T-T_1)^2}{2}$

所以每天总费用平均值 $C(T,Q)=\frac{\overline{C}}{T}=\frac{c_1}{T}+\frac{c_2Q^2}{2rT}+\frac{c_3(rT-Q)^2}{2rT}$ ，为保证 C 取最小值，故求偏导，使 $\frac{\partial C}{\partial T} = 0$ ，$\frac{\partial C}{\partial Q} = 0$

为避免与不允许缺货模型符号相同，故将 T 记为 T' , Q 记为 Q'

$T'=\sqrt{\frac{2c_1}{rc_2}\frac{c_2+c_3}{c_3}}$ ，$Q'=\sqrt{\frac{2c_1r}{c_2}\frac{c_3}{c_2+c_3}}$ ==注意：缺货需补足==

$Q'$ 为每周期初的存贮量，而对于每周期的生产量 R （或称为订货量） $R = rT'=\sqrt{\frac{2c_1r}{c_2}\frac{c_2+c_3}{c_3}}$ , $R=\mu Q>Q$ ，Q 为不允许缺货时的产量（或称为订货量）



#### 对比

允许缺货模型

$T'=\sqrt{\frac{2c_1}{rc_2}\frac{c_2+c_3}{c_3}}$ ，$Q'=\sqrt{\frac{2c_1r}{c_2}\frac{c_3}{c_2+c_3}}$

不允许缺货模型

$T=\sqrt{\frac{2c_1}{rc_2}}$ ， $Q=rT=\sqrt{\frac{2c_1r}{c_2}}$

将 $\mu=\sqrt{\frac{c_2+c_3}{c_3}}$ ，那么 $T'=\mu T$ ， $Q'=\frac{Q}{\mu}$

根据 $\mu$ 的表达式，可以得知 $\mu > 1$ ，故 $T' > T$ ， $Q' < Q$ ；若当 $c_3$ 增大时，此时 $\mu$ 将变小，若 $c_3\to\infty$ 时，那么 $\mu\to1$ ，此时 $T'\to T$ ， $Q'\to Q$



### 血管分支

问题：研究在能量最小原则下，血管分支处粗细血管半径比例和分岔角度



#### 模型假设

1. 一条粗血管和两条细血管在分支点对称地处于同一平面
2. 血液流动近似于粘性流体在刚性管道中的运动
3. 血液给血管壁的能量随管壁的内表面积和体积的增加而增加，管壁厚度 d 近似与血管半径 r 成正比

若设粗血管（AC）中流量为 q ，管壁厚度为 r ，运动距离为 l ，细血管（CB， CB'）中流量为 q1， 壁厚为 r1，运动距离为 l1 ，血管夹角为 $\theta$ ; B 点到粗血管中线的距离为 H ，A 点到 B 点的长度为 L

那么 q = 2q1 ，需要考虑 r/r1 及 $\theta$ 

根据流体力学，粘性流体在刚性管道中运动可知 $q=\frac{\pi r^4\Delta P}{8\mu l}$ ，其中 $\Delta p$ 为主血管 A 、 C 两点之间的压力差， $\mu$ 为粘性系数

同时根据能量公式，可知克服阻力消耗能量 $E_1 = q\Delta p = \frac{8\mu q^2l}{\pi r^4}$

由于血管还需要为人体提供能量，故设提供人体营养消耗能量为 $E_2 $ ,由于该能量应该与管壁内表面积及管壁体积有关，管壁内表面积为 $2\pi rl$ ，管壁体积为 $\pi(d^2+2rd)l$ ，根据假设，壁厚 d 应与 r 成正比；从简化角度出发，由于 $E_2$ 既与 r 的一次方有关，且与 r 的二次方有关，故设 $E_2 = br^\alpha l,1\leq \alpha \leq 2$



#### 模型建立

根据几何图形可知 $l = L-H/ \tan \theta$ ， $l_1=H/ \sin \theta$

那么粗血管和两条细血管消耗的总能量应该为 $E = E_1 + E_2=(kq^2/r^4+br^\alpha)l+(kq_1^2/r_1^4+br_1^\alpha)2l_1$ ，其中 $k = \frac{8\mu}{\pi}$

将 l 与 l1 代入可得 $E(r,r_1,\theta) = (kq^2/r^4+br^\alpha)(L-H/\tan\theta)+(kq_1^2/r_1^4+br_1^\alpha)2H/\sin\theta$



#### 模型求解

根据能量最小原理，需要求解 E 的最小能量，故对 E 的三个参数分别求偏导

$\frac{\partial E}{\partial r} = 0$ ， $\frac{\partial E}{\partial r_1} = 0$ 可知 $b\alpha r^{\alpha-1} - 4kq^2/r^5=0$ 及 $b\alpha r_1^{\alpha-1}-4kq_1^2/r_1^5=0$ ，根据前述 q = 2q1 ，最后可知 $\frac{r}{r_1} = 4^{\frac{1}{\alpha+4}}$

同时由于 $\frac{\partial E}{\partial \theta} = 0$ ，可知 $\cos \theta=2(\frac{r}{r_1})^{-4}$ ，将 r/r1 的代入可知 $\cos \theta = 2^{\frac{\alpha-4}{\alpha+4}}$

由于 $1 \leq \alpha \leq2$ ，所以 $1.26 \leq r/r_1\leq1.32$ ， $37^{\circ} \leq \theta \leq 49^{\circ}$



根据生物学家解剖试验说明：结果与观察大致吻合



#### 推论

大动脉到毛细血管假设有 n 次分岔

设大动脉半径为 $r_{max}$ ，毛细血管半径为 $r_{min}$ ，那么 $\frac{r_{max}}{r_{min}} =4^{\frac{n}{\alpha+4}}$

比如狗的血管 $r_{max} /r_{min} = 1000 \approx4^5$

那么 $ n\approx5(\alpha +4)$ ，因为 $1 \leq \alpha \leq2$ ，那么 $n\approx25-30$ ，故血管的总数大致为 $2^n\approx2^{25}-2^{30}\approx3\times 10^7-10^9$



### 冰山运输

#### 背景

1. 波斯湾地区水资源匮乏，淡化海水的成本为每立方米 0.1 英镑
2. 专家建议从 9600 km 原的南极用拖船运送冰山，取代淡化海水
3. 从经济角度研究冰山运输的可行性



#### 船舶日租金和最大运量

|      船型      |   小   |  中  |  大  |
| :------------: | :----: | :--: | :--: |
| 日租金（英镑） |  4.0   | 6.2  | 8.0  |
|    最大运量    | 5*10^5 | 10^6 | 10^7 |



#### 燃料消耗（英镑/km）

| 船速\冰山体积 | 10^5 | 10^6 | 10^7 |
| :-----------: | :--: | :--: | :--: |
|       1       | 8.4  | 10.5 | 12.6 |
|       3       | 10.8 | 13.5 | 16.2 |
|       5       | 13.2 | 16.5 | 19.8 |



####融化速率（m/天）

| 船速\与南极距离 |  0   | 1000 | >4000 |
| :-------------: | :--: | :--: | :---: |
|        1        |  0   | 0.1  |  0.3  |
|        3        |  0   | 0.15 | 0.45  |
|        5        |  0   | 0.2  |  0.6  |



#### 建模目的

选择船型和船速，使冰山到达目的地后每立方米水的费用最低，并与淡化海水的费用比较



#### 模型假设

1. 航行过程中船速不变，总距离 9600 km
2. 冰山呈球形，球面各点融化速率相同
3. 到达目的地后，每立方米可融冰 0.85 m^3 水



#### 建模分析

$船型、船速、船型\to燃料消耗、租金\to总费用$

同时船型将影响初始冰山体积，船型、船速和初始冰山体积将影响运输过程融化规律，而运输过程融化规律将影响目的地冰体积从而影响目的地水体积



#### 模型建立

##### 冰山融化规律

设船速为 u(km/h) ，与南极距离为 d(km) ，融化速率为 r (m/天)

假定 r 是 u 的线性函数，且当 d < 4000 时， u 与 d 成正比；

当 d > 4000 时， u 与 d 无关，凑出如下表达式

$$r=\begin{cases}a_1d(1+bu),&0\leq d\leq4000\\a_2(1+bu),&d>4000 \end{cases}$$

其中， $a_1=6.5\times10^{-5}$ ， $a_2=0.2$ ， $b=0.4$



那么当航行 t 天，距离 d 应为 24ut ，此时第 t 天的融化速率应为

$$r_t=\begin{cases}1.56\times10^{-3}u(1+0.4u)t,&0\leq t \leq\frac{1000}{6u}\\0.2(1+0.4u),&t>\frac{1000}{6u}\end{cases}$$



当冰山初始半径为 $R_0$ ，航行 t 天时半径为 $R_t=R_0-\sum\limits_{k=1}^{t}r_k$

冰山初始体积 $V_0=\frac{4\pi}{3}R_0^3$ ，那么第 t 天的体积为 $V_t=\frac{4\pi}{3}R_t^3$

对于选定的 u ，$V_0$ ，航行 t 天的冰山体积应为 

$$V(u,V_0,t) =\frac{4\pi}{3}((\frac{3V_0}{4\pi})^{1/3}-\sum\limits_{k=1}^tr_k)^3$$

总航行天数应为 $T=9600/24u=400/u$

故到达目的地时冰山体积应为

$$V(u,V_0) =\frac{4\pi}{3}((\frac{3V_0}{4\pi})^{1/3}-\sum\limits_{k=1}^Tr_i)^3$$



##### 燃料消耗

设燃料消耗为 $q_1(英镑/km)$ ， $q_1$ 应该对 u 是线性的，对 lgV 是线性的

故 $q_1=c_1(u+c_2)(lgV+c_3)$ ，其中 $c_1=0.3$ ， $c_2=6$ ，$c_3=-1$

那么对于选定 u ， $V_0$ 航行第 t 天燃料消耗 q (英镑/天)应为

$$q(u,V_0,t)=24u\cdot c_1(u+c_2)[lgV(u,V_0,t)+c_3]=7.2u(u+6)[lg\frac{4\pi}{3}((\frac{3V_0}{4\pi})^{1/3}-\sum\limits_{k=1}^tr_k)^3-1]$$

燃料消耗总费用为 $Q(u,V_0)=\sum \limits_{t=1}^Tq(u,V_0,t)$



##### 运送每立方米水费用

冰山初始体积 $V_0$ 的日租金 $f(V_0)$ 英镑，航行天数 $T=\frac{400}{u}$ ，故拖船租金费用 $R(u,V_0)=f(V_0)\cdot\frac{400}{u}$



故冰山运输总成本为 $S(u,V_0)=R(u,V_0)+Q(u,V_0)$

到达目的地时冰山体积 $$V(u,V_0) =\frac{4\pi}{3}((\frac{3V_0}{4\pi})^{1/3}-\sum\limits_{k=1}^Tr_i)^3$$

冰山到达目的地后得到的水体积 $W(u,V_0)=0.85V(u,V_0)$

运送每立方米水费用 $Y(u,V_0)=\frac{S(u,V_0)}{W(u,V_0)}$



#### 模型求解

求 u 和 V0 使 Y(u, V0) 最小，由于 V0 只能取离散值，同时经验公式很粗糙，故只取几组 u 和 V0 用枚举法计算

大致当 u = 4 - 5(km/h) ，$V_0=10^7(m^3)$ 时， $Y(u,V_0)$ 取最小值，此时大约为 0.065 英镑/m^3



虽然 0.065 英镑略低于淡化海水的成本 0.1 英镑，但是模型假设和构造非常简化和粗糙，同时未考虑航行过程中各种不利因素，故应当计算的 Y 值显著低于淡化海水成本时，才考虑其可行性



## 数学规划模型

线性规划、非线性规划、整数规划



### 奶制品的生产和销售

#### 企业生产计划

##### 空间层次

工厂级：根据外部需求和内部设备、人力、原料等条件，以最大利润为目标制订产品生产计划；

车间级：根据生产计划、工艺流程、资源约束及费用参数等，以最小成本为目标制订生产批量计划



##### 空间层次

若短时间内外部需求和内部资源等不随时间变化，可制订==单阶段生产计划（本节讨论）==，否则应制订多阶段生产计划



#### 例1 : 加工奶制品的生产计划

若加工 1 桶牛奶成 A1 产品，需要 12 h ，能得到 3 kg ，并且每千克获利为 24/kg ；

若加工 1 桶牛奶成 A2 产品，需要 8 h ，能得到 4 kg ，并且每千克获利为 16/kg ；

现有 50 桶牛奶，时间为 480 h ，至多加工 A1 产品 100 kg

问题1：需要制订计划，使每天获利最大？

问题2：若 35 元可买到 1 桶牛奶，买吗？若买，每天卖多少？

问题3：可聘用临时工人，付出的工资最多是每小时几元？

问题4：A1 的获利增加到 30 元/kg ，应否改变生产计划？



决策变量： x1 桶牛奶生产 A1 ， x2 桶牛奶生产 A2

目标函数： max z = 72 x1 + 64 x2

约束条件：x1 + x2 <= 50; 12x1 + 8x2 <= 480; 3x1 <= 100; x1 >= 0; x2 >= 0



##### 模型分析与假设

比例性：认为 $x_i$ 对目标函数及约束条件的贡献与 $x_i$ 取值成正比；在本例中，即认为 A1 ， A2 每千克的获利是与各自产量无关的常数，同时每桶牛奶加工 A1 , A2 的数量、时间是与各自产量无关的常数

可加性：认为 $x_i$ 对目标函数及约束条件的贡献与 $x_i$ 取值无关；在本例中，即认为 A1 ， A2 没千克的获利是与互相产量无关的常数，同时每桶牛奶加工 A1 ， A2 的数量、时间是与相互产量无关的常数

连续性：认为 $x_i$ 取值连续；在本例中，即认为加工 A1 , A2 的牛奶桶数是实数



##### 模型求解

使用 Lingo 软件求解

Model:
max = 72 * x1 + 64 * x2;
[milk] x1 + x2 <= 50; 
[time] 12 * x1 + 8 * x2 <= 480;
[A1] 3 * x1 <= 100;
end

>   Global optimal solution found.
>   Objective value:                              3360.000
>   Infeasibilities:                              0.000000
>   Total solver iterations:                             2
>
>   Model Class:                                        LP
>
>   Total variables:                      2
>   Nonlinear variables:                  0
>   Integer variables:                    0
>
>   Total constraints:                    4
>   Nonlinear constraints:                0
>
>   Total nonzeros:                       7
>   Nonlinear nonzeros:                   0
>
> ```c
>                             Variable           Value        Reduced Cost
>                                   X1        20.00000            0.000000
>                                   X2        30.00000            0.000000
>                                         // 表示剩余资源        // 表示在最优解条件下，资源增加 
>                                                               // 1 个单位，效益增加多少；或
>                                                               // 者说是购买该资源 1 个单位成
>                                                               // 本小于该值时，是可行的
>                                  Row    Slack or Surplus      Dual Price
>                                    1        3360.000            1.000000
>                                 MILK        0.000000            48.00000
>                                 TIME        0.000000            2.000000
>                                   A1        40.00000            0.000000
> ```
>

'[]' 中是为该行命名，方便在结果中查找；故最终 A1 使用 20 桶牛奶， A2 使用 30 桶牛奶



故前述问题中，35 元 < 48 元，故应该购买；并且对于工人，每小时可以提供 2 元薪资



同时， ==Lingo 还能完成敏感性分析==

>  Ranges in which the basis is unchanged:
>
> ```c
>                                    Objective Coefficient Ranges:
> 
>                                     Current        Allowable        Allowable
>                   Variable      Coefficient         Increase         Decrease
>                         X1         72.00000         24.00000         8.000000
>                         X2         64.00000         8.000000         16.00000
> 
>                                        Righthand Side Ranges:
> 
>                                     Current        Allowable        Allowable
>                        Row              RHS         Increase         Decrease
>                       MILK         50.00000         10.00000         6.666667
>                       TIME         480.0000         53.33333         80.00000
>                         A1         100.0000         INFINITY         40.00000
> ```
>

Objective Coefficient Ranges 指最优解不变时目标函数系数的允许变化范围（此时约束条件不变），本例中， x1 系数范围为 (64, 96) ； x2 系数范围为 (48, 72) ；故对于 A1 获利增加到 30元/kg ，系数为 30 * 3 = 90 仍在允许范围内

 Righthand Side Ranges 指影子价格不变时，约束条件可以变化的范围，如可以购进 10 桶牛奶，此时的影子价格仍为 48 元，但若超过 10 桶，影子价格将不明确，需要重新求解，但在 10 桶以内时可以保证获利



### 约束优化的简单分类

线性规划（LP）：目标和约束均为线性函数

非线性规划（NLP）：目标或约束中存在非线性函数；包括二次规划（QP），即目标为二次函数，约束为线性

整数规划（IP）：决策变量（全部或部分）为整数

1. 整数线性规划（ILP），整数非线性规划（INLP）
2. 纯整数规划（PIP），混合整数规划（MIP）
3. 一般整数规划， 0-1 （整数）规划



## 微分方程模型

###动态模型

1. 描述对象特征随时间（空间）的演变过程
2. 分析对象特征的变化规律
3. 预报对象特征的未来性态
4. 研究控制对象特征的手段



### 微分方程建模

1. 根据函数及其变化率之间的关系确定函数
2. 根据建模目的和问题分析作出简化假设
3. 按照内在规律或用类比法建立微分方程



### 传染病模型

#### 背景与问题

1. 描述传染病的传播过程
2. 分析受感染人数的变化规律
3. 预报传染病高潮到来的时刻
4. 预防传染病的手段



#### 基本方法

不是从医学角度分析各种传染病的特殊机理，而是按照传播过程的一般规律建立数学模型



#### 模型1

设已感染的人数（病人）为 $i(t)$

假设病人每天有效接触（足以使人致病）人数为 $\lambda$

那么建立模型 $i(t+\Delta t)-i(t)=\lambda i(t)\Delta t$ ，即为 $\frac{di}{dt}=\lambda i$ ，那么 $i(t)=i_0e^{\lambda t}$ ，且 $i(0) = i_0$ ，但当 $t\to \infty$ 时， $i\to\infty$ ，这明显是==有问题==的

问题在于病人每天接触的人并不都是正常人，若有效接触病人，则不能使病人数增加



#### 模型2—— SI 模型

区分已感染者（病人）和未感染者（健康人）

假设：

1. 总人数 N 不变，病人和健康人的比例分别为 $i(t)$ ， $s(t)$
2. 每个病人每天有效接触人数为 $\lambda$ ，且使接触的健康人都得病

那么可以建立模型 $N[i(t+\Delta t)-i(t)]=[\lambda s(t)]Ni(t)\Delta t$ ，微分后得 $\frac{di}{dt} = \lambda si$ ，且 $s(t)+i(t) = 1$ ，代入得

$$\begin{cases} \frac{di}{dt}=\lambda i(1-i)\\i(0)=i_0 \end{cases}$$

分离变量求解后得 $i(t) = \frac{1}{1+(\frac{1}{i_0}-1)e^{-\lambda t}}$

存在 t = tm ，使 $di/dt$ 达到最大值， tm 为传染病高潮到来时刻

因为 $di/dt$ 达到最大值时， i 应该为 1/2 ，所以可以求得相应的 tm 为 $t_m=\lambda^{-1}\ln(\frac{1}{i_0}-1)$

但当 $\lambda $ 减小时， $t_m$ 会增大，但只能延后传染病爆发时间，并不能真正反映实际情况（实际情况应该是控制在一定范围内，并不会爆发）



#### 模型3—— SIS 模型

传染病无免疫性——病人治愈为健康人，健康人可再次被感染

增加假设：病人每天治愈的比例为 $\mu$ ，即日治愈率

建模： $N[i(t+\Delta t)-i(t)]=\lambda Ns(t)i(t)\Delta t-\mu Ni(t)\Delta t$

可知 $\begin{cases} \frac{di}{dt}=\lambda i(1-i)-\mu i=-\lambda i[i-(1-\frac{1}{\sigma})]\\i(0)=i_0 \end{cases}$

其中， $\sigma=\lambda/\mu$ ，$\lambda$ 为日感染率； $1/\mu$ 为感染期；那么 $\sigma$ 为一个感染期内每个病人有效接触人数，称为==接触数==

通过绘图并分类讨论可知， $i(\infty) = \begin{cases}1-\frac{1}{\sigma},&\sigma>1\\0, &\sigma \leq 1  \end{cases}$

同时根据图像可知，当 $\sigma > 1$ ， $i_0<1-1/\sigma$ 时， $i(t)$ 将按 S 形曲线增长



此时，当 $\sigma \leq 1$ 时， $i(t)$ 将单调下降，说明感染期内有效接触使健康者感染的人数不超过原有的病人数



#### 模型4—— SIR 模型

传染病有免疫性——病人治愈后即移出感染系统，称为移出者

假设：

1. 总人数 N 不变，病人、健康人和移出者的比例分别为 $i(t)$ ， $s(t)$ ， $r(t)$
2. 病人的日接触率为 $\lambda$ ，日治愈率为 $\mu$ ，接触数为 $\sigma=\lambda/\mu$

可知：$s(t) + i(t) + r(t) = 1$

但仍需建立 $i(t)$ ， $s(t)$ ， $r(t)$ 的两个方程



$N[i(t+\Delta t)-i(t)]=\lambda Ns(t)i(t)\Delta t-\mu Ni(t)\Delta t$

$N[s(t+\Delta t)-s(t)]=-\lambda Ns(t)i(t)\Delta t$

求导后得

$$\begin{cases} \frac{di}{dt}=\lambda si-\mu i\\\frac{ds}{dt}=-\lambda si\\i(0)=i_0,s(0)=s_0 \end{cases}$$

其中 $i_0+s_0\approx1$ （通常 $r(0)=r_0$ 很小）

对于上述式子无法求出 $i(t)$ 和 $s(t)$ 的解析解；==但可以先做数值计算，再在相平面上研究解析解性质==



若消去 dt （上下两式相除）可得 $\frac{di}{ds}=\frac{1}{\sigma s}-1$ 及 $i|_{t=t_0}=i_0$

求解相轨线为 $i(s)=(s_0+i_0)-s+\frac{1}{\sigma}\ln \frac{s}{s_0}$ ,可知相轨线 $i(s)$ 的定义域 $D={(i,s)|s\geq0,i\geq0,s+i \leq1}$



由于 $s(t)$ 是单调递减的，说明相轨线方向始终往左

存在 $s = 1/\sigma$ 使 i 取极值 $i_m$ ，同时当 $t\to \infty$ 时， $i\to 0$ ，且 $s_{\infty} $ 满足 $s_0+i_0-s_{\infty}+\frac{1}{\sigma}\ln\frac{s_{\infty}}{s_0}=0$

说明，若初始 $s_0 > 1/\sigma$ ，那么 $i(t)$ 将先上升后降至 0 ，说明传染病蔓延

若初始 $s_0<1/\sigma$， 那么 $i(t)$ 将单调降至 0 ，传染病不蔓延



#### 预防传染病蔓延的手段

根据前文，传染病不蔓延的条件的是 $s_0 < 1/\sigma$

1. 提高阈值 $1/\sigma$ ，需要降低 $\sigma(=\lambda/\mu)$ 可以通过减小 $\lambda$ （减小接触率）或提高 $\mu$ （提高治愈率）实现

   $\lambda$ 降低需要提高卫生水平， $\mu$ 增大，需要提高医疗水平

2. 降低 $s_0$ ；这并不是意味着减少健康人群数量，也不可能是增大 $i_0$ ，那么便是提高 $r_0$ ，即通过群体免疫实现



对于 $\sigma$ 的估计

$s_0+i_0-s_{\infty}+\frac{1}{\sigma}\ln\frac{s_{\infty}}{s_0}=0$ ，由于初期 $i_0$ 较小，若忽略，便可得到 $\sigma=\frac{\ln s_0-\ln s_{\infty}}{s_0-s_{\infty}}$



#### 被传染人数的估计

记被传染的人数比例为 $x=s_0-s_{\infty}$

根据 $s_0+i_0-s_{\infty}+\frac{1}{\sigma}\ln\frac{s_{\infty}}{s_0}=0$ ,并假定 $i_0 = 0$ ，$s_0=1$ ，可得 $x+\frac{1}{\sigma} \ln(1-\frac{x}{s_0})=0$

若当 $x << s_0$ 时，可用泰勒级数展开上式，到平方项为止，那么 $x(1-\frac{1}{s_0\sigma}-\frac{x}{2s_0^2\sigma})\approx0$

可变化为 $x\approx2s_0 \sigma(s_0-\frac{1}{\sigma})$

设 $s_0-1/\sigma=\delta$ ，若当 $\delta$较小时，那么 $s_0\sigma\approx1$ ，那么 $x\approx2\delta$

从上式可知，若提高阈值 $1/\sigma$ ，可以降低被传染人数比例 x



####分析

模型 3， 4 ：描述传播过程，分析变化规律，预报高潮时刻，预防蔓延手段

模型 4 ：数值计算与理论分析相结合



### 正规战和游击战

#### 一般模型

设甲方兵力为 $x(t)$ ，乙方兵力为 $y(t)$

模型假设：

1. 每方战斗减员率取决于双方的兵力和战斗力
2. 每方非战斗减员率与本方兵力成正比
3. 甲乙双方的增员率为 $u(t)$ ， $v(t)$

模型：

$$\begin{cases} \dot{x}(t)=f(x, y)-\alpha x+u(t),&\alpha>0\\\dot{y}(t)=g(x,y)-\beta y+v(t),&\beta>0 \end{cases}$$

f ， g 取决于战争类型，分别为两方的战斗减员率； $\alpha$ 和 $\beta$ 为非战斗减员率



####正规战争模型（双方均以正规部队作战）

此时甲方的战斗减员率只取决于乙方的兵力和战斗力

$f(x,y)=-ay$ ，式中 a 表示乙方每个士兵的杀伤率

$a=r_yp_y$ ，$r_y$ 表示射击率， $p_y$ 表示命中率

同理， $g=-bx$ ， $b=r_xp_x$

若忽略非战斗减员且假设没有增援，那么 $\begin{cases} \dot{x}=-ay\\\dot{y}=-bx\\x(0)=x_0,y(0)=y_0 \end{cases}$

由于只需要判断战争的结局，不需要求 $x(t)$ 和 $y(t)$ ，而在相平面上讨论 x 与 y 的关系

故上式中的微分式相除可得 $\frac{dy}{dx}=\frac{bx}{ay}$ ，积分得 $ay^2-bx^2=k$ ，且 $k=ay_0^2-bx_0^2$

当 k > 0 时，若 x = 0 ，那么 y > 0 , 说明乙方胜利

且若 k  > 0 ,那么 $\frac{y_0}{x_0}>\frac{b}{a}=\frac{r_xp_x}{r_yp_y}$ ==称为平方率模型==

若 k < 0 ，那么相反，甲方胜利； k = 0 ，则为平局



#### 游击战争模型（双方都用游击部队作战）

甲方战斗减员率还随着甲方兵力的增加而增加

$f(x,y)=-cxy$ ，c 表示乙方每个士兵的杀伤率

$c=r_yp_y$ ， $r_y$ 表示射击率， $p_y$ 表示命中率

$p_y=\frac{s_{ry}}{s_x}$ ，$s_x$ 表示甲方活动面积， $s_{ry}$ 表示乙射击有效面积

同理，$g(x,y)=-dxy$ ， $d=r_xp_x=r_xs_{rx}/s_y$ 

若忽略非战斗减员，且假设没有增援

$\begin{cases} \dot{x}=-cxy\\\dot{y}=-dxy\\x(0)=x_0,y(0)=y_0 \end{cases}$

两式相除可得 $\frac{dy}{dx}=\frac{d}{c}$ ，化简得 $cy-dx=m$ ，且 $m=cy_0-dx_0$

若 m > 0 ,由于 x = 0 时， y  > 0 ，说明此时乙方胜利，同时 $\frac{y_0}{x_0}>\frac{d}{c}=\frac{r_xs_{rx}s_x}{r_ys_{ry}s_y}$ ==称为线性率模型==

若 m < 0 ,相反，甲方胜利；若 m = 0 ，平局



####混合战争模型（甲方为游击部队，乙方为正规部队）

此时$\begin{cases} \dot{x}=-cxy\\\dot{y}=-bx\\x(0)=x_0,y(0)=y_0 \end{cases}$

积分得 $cy^2-2bx=n$ ，且 $n=cy_0^2-2bx_0$

当 n > 0 时，乙方取得胜利，此时 $(\frac{y_0}{x_0})^2>\frac{2b}{cx_0}=\frac{2r_xp_xs_x}{r_ys_{ry}x_0}$

若假设 $x_0 = 100$ ， $r_x/r_y=1/2$ ， $p_x=0.1$ ， $s_x=1(km^2)$ ， $s_{rx}=1(m^2)$

那么此时 $(y_0/x_0)^2>100$ ，说明乙方若需要打败甲方，此时初始人数需要为甲方初始人数的 10 倍，即 1000 人



### 香烟过滤嘴的作用

####问题：

1. 过滤嘴的作用与它的材料和长度有什么关系
2. 人体吸入的毒物量与哪些因素有关，其中什么因素影响大，什么因素影响小？



####模型分析：

1. 分析吸烟时毒物进入人体的过程，建立吸烟过程的数学模型
2. 设想一个 "机器人" 在典型环境下吸烟，吸烟方式和外部环境在整个过程中不变



#### 模型假设

1. 设 l1 为烟草长度， l2 为过滤嘴长度，总长 l = l1 + l2 ；毒物量 M 均匀分布，密度 w0 = M / l1
2. 点燃处毒物随烟雾进入空气和沿香烟穿行的数量比是 a' ： a ， a' + a = 1
3. 未点燃的烟草和过滤嘴对随烟雾穿行的毒物的（单位时间）吸收率分别是 b 和 $\beta$
4. 烟雾沿香烟穿行速度是常数 v ，香烟燃烧速度是常数 u ， v >> u



#### 定性分析

设 Q 为吸一支烟毒物进入人体总量

那么当 $\beta \uparrow$ 、 $l_2\uparrow$ 、 $M\downarrow$ 、 $a\downarrow$ 、 $v\downarrow$ 时， $Q\downarrow$

当 b 、 $l_1$ 、和 u 变化时， Q 如何变化需要进行定量分析才能确定



#### 模型建立

当 t = 0 且 x = 0 时，点燃香烟

设毒物流量为 $q(x,t)$ ，毒物密度为 $w(x,t)$ ，当 t = 0 时，毒物密度相同，故 $w(x,0)=w_0$

由于吸入人体的毒物只与 x = l 处的毒物流量有关，可知 $Q=\int_0^Tq(l,t)dt$ ，其中 $T=l_1/u$



为求流量密度，设 $q(x,0)=q(x)$ ，根据流量守恒

$$q(x)-q(x+\Delta x)=\begin{cases} bq(x)\Delta \tau,&0\leq x \leq l_1\\\beta q(x)\Delta \tau,&l_1 \leq x \leq l \end{cases}$$

根据微段法，可得如上式子，该式说明了微段两端的毒物流量变化量，其中 $\Delta \tau=\Delta x/v$

代入可得

$$\frac{dq}{dx}=\begin{cases}-\frac{b}{v}q(x),&0 \leq x \leq l_1 \\ -\frac{\beta}{v}q(x)m&l_1 \leq x \leq l  \end{cases}$$

上式的初始条件是 $q(0) = aH_0$ 及 $H_0=aw_0$ ，即 x = 0 时，香烟端头的毒物流量为 $H_0$ ,但只有 a 部分流入香烟，同时由于速度和密度已知，故可表示 $H_0$

故求解得

$$q(x)=\begin{cases}aH_0e^{-\frac{bx}{v}}, 0 \leq x \leq l_1\\aH_0e^{-\frac{bl_1}{v}}e^{-\frac{\beta(x-l_1)}{v}},&l_1 \leq x \leq l  \end{cases}$$



求 t 时刻 l 处的毒物流量 $q(l,t)$ ，此时香烟燃至 x = ut

与上述推论进行类比，只要知道 x = ut 处的毒物流量 H(t) ，并假定此处为始点，那么便可推出类似的公式

$H_0\implies H(t)=uw(ut,t)$ ，$x \implies x-ut(ut \leq x \leq l_1)$ ， $l_1 \implies l_1-ut(l_1 \leq x \leq l)$

此时类似公式为

$$q(x)=\begin{cases}aH(t)e^{-\frac{b(x-ut)}{v}}, ut \leq x \leq l_1\\aH(t)e^{-\frac{b(l_1-ut)}{v}}e^{-\frac{\beta(x-l_1)}{v}},&l_1 \leq x \leq l  \end{cases}$$

此时 $q(l,t)=auw(ut,t)e^{-\frac{b(l_1-ut)}{v}}e^{-\frac{\beta l_2}{v}}$

此时，便将问题转化求解 w(ut, t)



#####求 $w(ut,t)$

通过考察 $\Delta t $ 内毒物密度的增量

$$w(x,t + \Delta t)-w(x,t)=b\frac{q(x,t)}{v}\Delta t$$ ，即单位长度烟雾毒物被吸收部分

由于 $$q(x)=aH(t)e^{-\frac{b(x-ut)}{v}}$$ ,且$ H(t)=uw(ut,t)$  ，对 t 求偏微分得

$$\frac{\partial w}{\partial t}=\frac{b}{v}auw(ut,t)e^{-\frac{b(x-ut)}{v}}$$ 且 $w(x,0) =w_0$

求得 $w(ut,t)=\frac{w_0}{a'}(1-ae^{-\frac{a' but}{v}})$ 



##### 计算 Q

将 $w(ut,t)$ 代入到 $q(l,t) $ 中，得 $q(l,t)=\frac{auw_0}{a'}e^{\frac{bl_1}{v}}e^{-\frac{\beta l_2}{v}}(e^{-\frac{but}{v}}-ae^{-\frac{abut}{v}})$

对 q 积分，可得 $Q = \int_0^{l_1/u}q(l,t)dt=\frac{aw_0v}{a'b}e^{-\frac{\beta l_2}{v}}(1-e^{-\frac{a'bl_1}{v}})$

$$Q=aMe^{-\frac{\beta l_2}{v}}\varphi(r)$$ ，其中 $r=\frac{a'bl_1}{v}$ ， $\varphi(r)=\frac{1-e^{-r}}{r}$



#### 结果分析

1. Q 与 a , M 成正比， aM 是毒物集中在 x = 0 处的吸入量

2. $e^{-\frac{\beta l_2}{v}}$ 是过滤嘴因素，$\beta$ 和 $l_2$ 两者乘积对吸入量呈负指数作用

   $aMe^{-\frac{\beta l_2}{v}}$ 是毒物集中在 x = l1 处的吸入量

3. $\varphi(r)$ 是烟草的吸收作用

4. 与另一支不带过滤嘴的香烟对比，吸至 x = l1 扔掉

   $$Q_1=\frac{aw_0v}{a'b}e^{-\frac{b l_2}{v}}(1-e^{-\frac{a'bl_1}{v}})$$ 带过滤嘴 

   $$Q_2=\frac{aw_0v}{a'b}e^{-\frac{\beta l_2}{v}}(1-e^{-\frac{a'bl_1}{v}})$$ 不带过滤嘴

   $\frac{Q_1}{Q_2}=e^{-\frac{(\beta-b)l_2}{v}}$ ，因为 $\beta>b$ ，所以 $Q_1<Q_2$ ，且由于 $\beta -b$ 与 $l_2$ 都是一次，说明提高两者的效果相同



## 代数方程与差分方程模型

### CT 技术的图像重建

CT 技术：在==不同深度==的断面上，从==各个角度==用探测器接收旋转的 X 光管发出、穿过人体而使==强度衰减的射线==



#### X 射线强度衰减与图像重建的数学原理

设射线强度为 $I$ ，物质在射线方向的厚度为  $l$ ，入射强度为 $I_0$ ，物质对射线的衰减系数为 $\mu$

当物质均匀时，涉嫌强度的衰减率与强度成正比，即 $\frac{dI}{dl}=-\mu I$ ，得 $I=I_0e^{-\mu I}$

若射线沿直线 L 穿行，穿过由不同衰减系数的物质组成的非均匀物体（人体器官）时

$\mu I=\int_L\mu(x,y)dl$ ，那么 $I=I_0exp(-\int_L\mu(x,y)dl)$ ，转化得 $\int_L\mu(x,y)dl=\ln \frac{I_0}{I}$



由于上式右端数值可以通过 CT 的测量数据得到，而==图像重建==的目的便是从 $\int_L\mu(x,y)dl$ 找到被积函数 $\mu(x,y)$ ，从而根据该数值反应人体器官大小、形状、密度的图像



##### 数学原理

数学上称之为拉东变换，即 $P_f(L)=\int_Lf(x,y)dl$ 求解方法为 $f(Q)=-\frac{1}{\pi}\int_0^{\infty}\frac{dF_Q(q)}{q}$ ，即逆拉东变换

Q 即为 (x, y) ，$F_Q(q)$ 为与 Q 相距 q 的直线 L 的线积分 $P_f(L)$ 对所有 q 的平均值

但该方法只是理论情况，==实际只能在有限条直线上得到投影==



#### 图像重建的代数模型

由于上述数学原理难以实现，故将非均匀物质划分为 m 个像素，通过 n 条射线进行求解

那么对于每个像素，射线的衰减系数都是常数

$\mu_j$ 为像素 j 的衰减系数

$\Delta l_j$ 为射线在像素 j 中的穿行长度

$J(L_i)$ 为射线 $L_i$ 穿过的像素 j 的集合

$\ln(I_0/I)$ ~ Li 是通过 CT 仪器测得的强度数据

那么 $\int_L\mu(x,y)dl=\ln \frac{I_0}{I}$ 可转换为 $\sum \limits_{j \in J(L_i)}\mu_j\Delta l_j=\ln(I_0/I)_i,i=1,2,...,n$



所以需要知道在各个像素中穿行的长度 $\Delta l_j$

常用算法（将 $\ln(I_0/I) $ $b_i$ 表示， $\mu j$ 用 $x_j$ 表示）

设像素的边长和射线的宽度均为 $\sigma$ 

1. 中心线法

   采用射线的中心线穿过的长度作为穿行长度， $a_{Ij}$ 表示射线 $L_i$ 的中心线在像素 j 内的长度与 $\sigma$ 之比，那么

   $\sum \limits_{j \in J(L_i)}\mu_j\Delta l_j=\ln(I_0/I)_i=\sum \limits_{j=1}^ma_{ij}x_j=b_i,i=1,2,...,n$ ，即 $Ax=b$

2. 面积法

   $a_{ij}$ 表示为射线 $L_i$ 在像素 j 内的面积 $s_{ij}$ 与像素面积 $\sigma^2$ 之比

3. 中心法

   认为若射线中心线与像素相交便取 1 ，若不相交，则取 0



##### 中心法的简化形式（代数重建技术 ART）

假定射线的宽度为零，间距为 $\sigma$ ，若 $L_i$ 经过像素 j 内任一点，那么 $a_{ij}=1$

从而写出 A 矩阵，A 应为 n * m 阶矩阵

根据 A 和 b ，由 Ax = b 确定像素的衰减系数向量 x ，但由于像素往往划分较密，数量很大，虽然射线也较多，但一般都小于 m ，故方程将有无穷多解；此时需要考虑测量误差和噪声，即

$Ax+e=b$ ，在 x 和 e 满足的最优准则下估计 x



### 原子弹爆炸的能量估计

爆炸产生的冲击波以爆炸点为中心呈球面向四周传播，爆炸的能量越大， 在一定时刻冲击波传播得越远

冲击波由爆炸形成的蘑菇云反映出来。

泰勒通过测量数据（时刻 t 所对应的蘑菇云半径 r），并且用==量纲分析法==建立数学模型，辅以小型试验，完成对爆炸的能量进行估计



#### 量纲齐次原则

等式两端的量纲一致

量纲分析：利用量纲齐次原则寻求物理量之间的关系



#### 原子弹爆炸能量估计的量纲分析法建模

记爆炸能量为 E ，将蘑菇云近似看成一个球形

时刻 t 球的半径为 r ，r 与时间 t ，爆炸能量 E ，空气密度 $\rho$ ，大气压强 P 有关

故令 $f(r,t,E,\rho,P)=0$ ，基本量纲为 L ， M ，T

将各个参数用基本量纲表示， $[r]=L$ ； $[t]=T$ ； $[E]=L^2MT^{-2}$ ； $[\rho]=L^{-3}M$ ； $[P]=L^{-1}MT^{-2}$

得到量纲矩阵 $A_{3\times5}$为

|  1   |  0   |  2   |  -3  |  1   |  L   |
| :--: | :--: | :--: | :--: | :--: | :--: |
|  0   |  0   |  1   |  1   |  1   |  M   |
|  0   |  1   |  -2  |  0   |  -2  |  T   |
|  r   |  t   |  E   |  p   |  P   |      |



A 矩阵 rank 为 3 ，故 $Ay=0$ ， $y=(y_1,y_2,y_3,y_4,y_5)^T$ 有两个基本解， $y=(1,-2/5,-1/5,1/5,0)$ ， $y=(0,5/6,-2/5,-3/5,1)$ ，故可得到两个无量纲量

$\pi_1=rt^{-2/5}E^{-1/5}\rho^{1/5}=r(\frac{\rho}{t^2E})^{1/5}$

$$\pi_2=t^{6/5}E^{-2/5}\rho^{-3/5}P=(\frac{t^6P^5}{E^2P^3})^{1/5}$$

故 $F(\pi_1,\pi_2)=0$

可得两个无量纲量之间应满足

$$r(\frac{\rho}{t^2E})^{1/5}=\Psi (\frac{t^6P^5}{E^2P^3})^{1/5}$$

故$$r=(\frac{t^2E}{\rho})^{1/5}\Psi (\frac{t^6P^5}{E^2P^3})^{1/5}$$

由于时间 t 非常短，而能量 E 非常大，所以 $$\Psi (\frac{t^6P^5}{E^2P^3})^{1/5}\approx \Psi(0)$$

同时，泰勒根据小型爆炸试验的数据建议 $\Psi(0) \approx1$

故 $r=(\frac{t^2E}{\rho})^{1/5}$ ，同时，空气密度 $\rho=1.25(kg/m^3)$

用 r , t 的实际数据做平均，可得 $E=8.2825\times10^{13}$ 焦耳

由于 1 千吨（TNT 能量）为 $4.184*10^{12}$ 焦耳，故大致估算 E 为 19.7957 千吨 TNT



#### 模型检验

由于可通过 $r=(\frac{t^2E}{\rho})^{1/5}$ 公式，得知 r 与 t 应该是 2/5 次的关系

若用最小二乘法拟合， $r=at^b$ ，将测量的数据代入，可得 b = 0.4058 ,所以结果符合要求



### 按年龄分组的种群增长

不同年龄组的繁殖率和死亡率不同

以雌性个体数量为对象

建立差分模型，讨论稳定状况下种群的增长规律



#### 假设与建模

1. 种群按年龄大小等分为 n 个年龄组，记为 i = 1， 2， ... ， n
2. 时间离散为时段，长度与年龄组区间相等，记为 k = 1， 2，..
3. 第 i 年龄组 1 个雌性个体在 1 时段内的繁殖率为 bi
4. 第 i 年龄组在 1 时段内的死亡率为 di ，存活率为 si = 1 - di



设 $x_i(k)$ 为时段 k 第 i 年龄组的种群数量

那么 $x1(k+1)=\sum \limits_{i=1}^nb_ix_i(k)$ ,此时至少 1 个 $b_i>0$

$x_{i+1}(k+1)=s_ix_i(k),i=1,2,...,n-1$

用矩阵表示，如 $x(k)=[x_1(k),x_2(k)...x_n(k)]^T$

并且引入 Leslie 矩阵 

$$L=\begin{bmatrix}b_1&b_2&...&b_{n-1}&b_n\\s_1&0&...&0&0\\0&s_2&...&0&0\\...\\0&0&...&s_{n-1}&0 \end{bmatrix}$$

那么 $x(k+1)=Lx(k)$ ，即 $x(k)=L^kx(0)$ ，这样便可预测任意时段种群按年龄组的分布



#### 稳定状态分析的数学知识

L 矩阵存在==正单特征根== $\lambda_1$ ，$|\lambda_k| \leq \lambda_1,k=2,3,...n$

特征向量 $x^*=[1,\frac{s_1}{\lambda_1},\frac{s_1s_2}{\lambda_1^2},...,\frac{s_1s_2...s_{n-1}}{\lambda_1^{n-1}}]$

若 L 矩阵存在 $b_i,b_{i+1}>0$ ，则 $|\lambda_k|<\lambda_1,k=2,3,...,n$

且 $\lim\limits_{k\to \infty}\frac{x(k)}{\lambda_1^k}=cx^*$ ，c 是由 bi , si , x(0) 决定的常数



## 稳定性模型

### 人口的预测和控制（需要其内部分知识）

常用的计算公式：今年的人口为 $x_0$ ，年增长率为  $r$

k 年以后人口 $x_k=x_(1+r)^k$

##### 马尔萨斯指数增长模型

基本假设：人口（相对）增长率 r 是常数

设 x(t) 为时刻 t 的人口

那么 $\frac{x(t+\Delta t)-x(t)}{x(t)}=r\Delta t$ ，所以 $\frac{dx}{dt}=rx$ ， $x(0)=x_0$ ，故 $x(t)=x_0e^{rt}$ 形式与常用公式一致



##### 指数增长模型的应用和局限性

1. 与 19 世纪以前欧洲一些地区人口统计数据吻合
2. 适用于 19 世纪后前往加拿大的欧洲移民后代
3. 可用于短期人口增长预测
4. 不符合 19 世纪后多数地区人口增长规律
5. 不能预测较长期的人口增长过程

原因在于 19 世纪后，人口增长率 r 不是常数（逐渐下降）



##### 阻滞增长模型—— Logistic 模型

人口增长到一定数量后，增长率下降的原因：

资源、环境等因素对人口增长的阻滞作用，且阻滞作用随人口数量增加而变大，说明 r 是 x 的减函数

假设 $r(x)=r-sx(r,s>0)$ ，r 为固有增长率（x 很小时）， $x_m$ 设为人口容量（资源、环境能容纳的最大数量）

那么 $r(x_m)=0$ ，可得 $s=\frac{r}{x_m}$ ，代入可得 $r(x)=r(1-\frac{x}{x_m})$



故$\frac{dx}{dt}=r(x)x=rx(1-\frac{x}{x_m})$

积分可得 $x(t)=\frac{x_m}{1+(\frac{x_m}{x_0}-1)e^{-?}}$



###  捕鱼业的持续收获

设渔场鱼量为 x(t)

假设：无捕捞时鱼的自然增长服从 Logistic 规律，即 $\dot{x}(t)=f(x)=rx(1-\frac{x}{N})$

其中 r 为固有增长率， N 为最大鱼量

并且假设单位时间捕捞量与渔场鱼量成正比，故 $h(x)=Ex$ ，其中 E 为捕捞强度



#### 建模

记 $F(x)=f(x)-h(x)$

故捕捞情况下，渔场鱼量满足 $\dot{x}(t)=f(x)=rx(1-\frac{x}{N})-Ex$

问题：不需要求解 x(t) ，只需知道 x(t) 稳定的条件



#### 一阶微分方程的平衡点及其稳定性

若一阶非线性微分方程右端不含 t ，则称其为自治方程，如 $\dot{x}=F(x)$

而 $F(x)=0$ 的根 $x_0$ 被称为微分方程的平衡点



设 $x(t)$ 是方程的解，若从 $x_0$ 某领域的任一初值出发，都有 $\lim \limits_{t\to\infty}x(t)=x_0$ ，那么称 $x_0$ 是方程 $\dot{x}=F(x)$ 的稳定平衡点



不求 $x(t)$ ，判断 $x_0$ 稳定性的方法——直接法

由于 $\dot{x}=F(x)$ 的近似方程（在 x = x0 的展开式）为 $\dot{x}=F'(x_0)(x-x_0)$ ，说明 x 的导数只与某一常数 a 和 x 的乘积有关，若积分可知，x 的表达式中将有 $e^{at}$ 的项，当 a > 0 时，x 将为无穷大，不满足；故只有当 a < 0 时，此时表示 $F'(x_0)<0$ 时才能满足稳定要求



故对于原模型，先求 $F(x)=0$ 时， x 的数值，$x_0=N(1-E/r)$ ，$x_1=0$

所以，稳定性判断为 $F'(x_0)=E-r$ ， $F'(x_1)=r-E$

当 $E<r$时， $F'(x_0) <0,F'(x_1)>0$ ，说明 x0 稳定， x1 不稳定

当 $E>r$时， $F'(x_0) >0,F'(x_1)<0$ ，说明 x0 不稳定， x1 稳定

但当 x1 稳定时，可见渔场鱼量为 0 ，不满足；故只有当 x0 稳定，可得到稳定产量



#####产量模型

在捕捞量稳定的条件下，控制捕捞强度使产量最大

产量为 $h(x)=Ex$

只有当 $E<r$ 时，才能在 $x_0$ 保持稳定，说明 f 和 h 必须会有交点，但可以调整 E 的值，使 h 转动，明显，当交点为 f 的最大值时，捕捞量 h 也将达到最大值，此时需要控制渔场鱼量为最大鱼量的一半，即 N/2 ，最大捕捞量为 rN/4 ，捕捞强度为 E = r/2



##### 效益模型

在捕捞量稳定的条件下，控制捕捞强度使==效益==最大

假设鱼的销售价格为 p ，单位捕捞强度费用为 c

收入为 T = ph(x) = pEx ，支出为 S=cE

单位时间利润为 R = T - S = pEx - cE ，稳定平衡点为 $x_0=N(1-E/r)$

求 E 使 R(E) 最大，此时，$E_R=\frac{r}{2}(1-\frac{c}{pN})$ ，小于产量模型中的捕捞强度

此时渔场鱼量应为 $x=N(1-\frac{E_R}{r})$



##### 捕捞过度

上述都讨论的是封闭式捕捞，此时追求利润最大

若开放式捕捞，只追求利润 R > 0，那么根据 R = T - S = pEx - cE ，稳定平衡点为 $x_0=N(1-E/r)$

可知 $E_s=r(1-\frac{c}{pN})$

说明，当 R = 0时，捕捞强度 $E_s=2E_R$ ，此为临界强度

临界强度下的渔场鱼量 $x_s=N(1-\frac{E_s}{r})=\frac{c}{p}$

说明，此时的鱼量由成本-价格决定，当价格上升，成本下降，那么捕捞强度 $E_s$ 将变大， $x_s$ 将变小，正是过度捕捞



###食饵-捕食者模型（种群的弱肉强食）

种群甲靠丰富的天然资源生存，种群乙靠捕食甲为生，形成食饵—捕食者系统

设食饵（甲）数量 x(t) ，捕食者（乙）数量 y(t)

甲独立生存的增长率 r ，则 $\dot{x}=rx$

乙使甲的增长率减小，减小量与 y 成正比， $\dot{x}(t)=(r-ay)x=rx-axy$

乙独立生存时的死亡率为 d , $\dot{y}=-dy$

甲使乙的死亡率减小，减小量与 x 成正比，$\dot{y}(t)=-(d-bx)y=-dy+bxy$



模型的平衡点及其稳定性

由于现为方程组，若需要求平衡点便需要同时考虑 x 和 y

平衡点有 P(d/b, r/a) 和 P'(0, 0)

若对方程组求偏导，可得雅各比矩阵

$$A=\begin{bmatrix}r-ax&-ax\\by&-d+bx \end{bmatrix}$$

将 P 和 P' 两点代入，可得

$$A|_P=\begin{bmatrix}0&-ad/b\\br/a&0 \end{bmatrix}$$

可得 p = 0, q > 0 ，说明 P 处于临界状态

$$A|_P=\begin{bmatrix}r&0\\0&-d \end{bmatrix}$$

此时， q < 0 ，说明 P' 处于不稳定状态

（p 、q为特征根，若存在复数，则考虑特征根的实部）



所以 P 点稳定性不能用近似线性方程分析，需要考虑其他方法