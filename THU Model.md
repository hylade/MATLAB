##初等模型

### 光盘的数据容量

CD 的数据容量：单层 650 MB

DVD 的数据容量：单层 4.7 GB

==从数学建模的角度研究：光盘的数据容量是怎么确定的，在一定条件下怎样使其最大化==

怎样存储？经过编码的数字信息，以一定深度和宽度、不同长度的凹坑的形式，用烧蚀技术存储在光盘表面呈螺旋线形状的信道上；信道需要有信道间距

当光盘上环形区域面积一定时，数据容量的大小取决于信道的==总长度==与信道上存储数据的==线密度（即单位长度上存储信息量）==

决定信道长度（考虑信道间距）和线密度大小的主要因素是所用==激光的波长和驱动光盘的机械形式==

$$激光波长、驱动形式 \to信道长度、线密度\to数据容量$$:kissing_smiling_eyes:



#### 激光波长

1. 当光盘运转时，激光束要能识别出信道上的凹坑所携带的信息，必须精确地聚焦
2. 光的衍射使激光束在光盘上形成圆形的光斑（说明在读取信息时，光点并不是数学上所说的没有大小的点，而是具有一定直径的圆）
3. 为了提高存储数据的线密度，应该使光斑尽量小，而光斑的大小与激光波长成正比（激光波长越长，光斑越大），故为了增加存储量，应该使用波长较小的激光

|   激光器    | 激光波长（$\mu$m） | 光斑直径（$\mu$m） | 信道间距（$\mu$m） | 数据线密度（字节/mm） |
| :---------: | :----------------: | :----------------: | :----------------: | :-------------------: |
| 红外（CD）  |        0.78        |         2          |        1.6         |          121          |
| 红外（DVD） |        0.64        |       0.925        |        0.74        |          387          |
| 蓝色（DVD） |        0.41        |        0.4         |        0.32        |          800          |



#### 驱动光盘的机械形式

恒定角速度（CAV）或者恒定线速度（CLV）

当为恒定角速度时，每一圈螺旋线上存储同等数量的数据信息；容量取决于最内圈的长度、线密度以及总圈数

当为恒定线速度时，各圈螺旋线上数据的线密度不变；容量取决于固定的线密度和螺旋线总长度；

但从容量角度将，CLV 方式应该优于 CAV 方式；同时为了保证线速度相等， CLV 每圈转速不同，当读出磁头在内外圈移动时，需要等待光盘加速和减速而 CAV 不需要，故两者读取时间不同



#### 应用

对音乐、影像、计算机文件等按顺序播放的信息，多用 CLV；

对词典、数据库、人机交互等常要随机查找的信息，多用 CAV（为了保证查找精度和速度）



#### 模型建立

对于 CLV 光盘，数据容量 $C_{CLV} = \rho L_{CLV}$ ，式中 $\rho$ 为线密度， $L_{CLV}$ 为信道总长度

由于信道为螺旋线，其长度求解较为困难，在此简化为同心圆进行求解

$$L_{CLV} \approx \sum \limits_{k = 0}^{n-1}2\pi(R_1+kd)=\frac{\pi(R_2-R_1)(R_2+R_1-d)}{d}$$ 

==其他方法==

通过面积除以信道间距求得长度 $L_{CLV} \approx \frac{\pi(R_2^2-R_1^2)}{d}$

通过同心圆平均周长 * 总圈数 $L_{CLV} = 2\pi \frac{R_2+R_1}{2}\frac{R_2-R_1}{d}$



对于 CAV 光盘，数据容量 $C_{CAV} = \rho L_{CAV}$ ，式中 $\rho$ 为线密度， $L_{CAV}$ 为信道总长度

螺旋线最内圈的长度近似为 $2\pi R_1$ ，总圈数可视为 $\frac{R_2-R_1}{d}$

由于只能按照最内圈的线密度和信道长度计算，故 $L_{CAV} =2\pi R_1 \frac{R_2-R_1}{d}$

当给定线密度 $\rho$ ，信道间距 $d$ 和外径 $R_2$ 后，可选择环形区域的内圈半径 $R_1$ ，使数据容量最大



#### 分析

对于 CLV 光盘，将 $L_{CLV}$ 简化为 $L_{CLV} \approx \frac{\pi(R_2^2-R_1^2)}{d}$

并根据一般光盘的大小， $R_2 = 58mm,R_1=22.5mm$ ，可知（影像时间按每秒钟占用 0.62 MB计算）

|   激光器    | 激光波长（$\mu$m） | 信道长度（mm） | 信息容量（MB） | 影像时间（min） |
| :---------: | :----------------: | :------------: | :------------: | :-------------: |
| 红外（CD）  |        0.78        |   5,611,179    |      679       |       18        |
| 红外（DVD） |        0.64        |   12,132,279   |     4,695      |       126       |
| 蓝色（DVD） |        0.41        |   28,055,895   |     22,445     |       603       |

对于 CLV 光盘，不存在最大值，只要信道足够长，那么存储量将一直增加



对于恒定角速度光盘，由于 $L_{CAV} =2\pi R_1 \frac{R_2-R_1}{d}$ ，当 $R_1=R_2/2$ 时，可使 $L_{CAV}$ 达到最大值，此时为 $\frac{\pi R_2^2}{2d}$

此时，光盘的存储信息等为

|   激光器    | 激光波长（m） | 信道长度（mm） | 信息容量（MB） | 影像时间（min） |
| :---------: | :-----------: | :------------: | :------------: | :-------------: |
| 红外（CD）  |     0.78      |   3,302,599    |      400       |       11        |
| 红外（DVD） |     0.64      |   7,140,755    |     2,764      |       74        |
| 蓝色（DVD） |     0.41      |   16,512,996   |     13,210     |       355       |

但即使内圆半径为最佳选择， CAV 光盘的信息容量也小于 CLV 光盘



### 核军备竞赛

求解在什么情况下双方的核军备竞赛不会无限扩张，而存在暂时的平衡状态；同时估计平衡状态下双方拥有的最少的核武器数量，这个数量受哪些因素影响；当一方采取加强防御、提高武器精度、发展多弹头导弹等措施时，平衡状态将发生什么变化



#### 模型假设

以双方（战略）核导弹数量描述核军备的大小

假定双方采用如下同样的==核威慑战略==：

1. 认为对方可能发起所谓第一次核打击，即倾其全部核导弹攻击己方的核导弹基地
2. 己方在经受第一次核打击后，应保存足够的核导弹，给对方重要目标以毁灭性打击
3. 在任一方实施第一次核打击时，假定一枚核导弹只能攻击对方的一个核导弹基地（认为一个基地只存有核导弹）
4. 摧毁这个基地的可能性是常数，它由一方的攻击精度和另一方的防御能力决定



#### 图的模型

设 y = f(x) ，表示甲有 x 枚导弹，乙所需要的最少导弹数（乙安全线）

设 x = f(y) ，表示乙有 y 枚导弹，甲所需要的最少导弹数（甲安全线）（这两条线应互为反函数，以 y = x 为对称轴对称）

当 x = 0 时，y = y0 ，此时 y0 表示为乙方的威慑值，即当甲方实行第一次打击后已经没有导弹或者原本就没有导弹时，乙方为摧毁甲方工业、交通中心等目标所需导弹数目

故可知 y = f(x) 应大于 y0 ，同时，由于每次导弹打击并不能都能命中，故 y = f(x) 应小于 y0 + x

由此可大致绘出 y = f(x) 的线条，再根据对称轴 y = x ，绘制出 x = g(y) 的线条；由于 y = f(x) 上侧是乙方的安全区， x = g(y) 下侧是甲方的安全区，故两条线应有交点 P(Xm, Ym) ，此为平衡点，此时的双方的导弹数目最少



### 分析模型

假定乙方残存率为 s ：表示甲方一枚导弹攻击乙方一个基地，基地未被摧毁的概率

当 x < y ：甲方以 x 枚导弹攻击乙方 y 个基地中的 x 个，此时 sx 个基地未被摧毁， y-x 个基地未被攻击

故： $y_0 = sx + y-x$ ，得 $y = y_0 + (1-s)x$

当 x = y ：将上式化简得 $y_0=sy$ ， $y = y_0/s$

当 y < x < 2y ：乙方的 x-y 个基地被攻击两次，故 $s^2(x-y)$ 个基地未被摧毁； $y-(x-y)=xy-x$ 个基地被攻击 1 次，故将有 $s(2y-x)$ 个未被摧毁

故： $y_0 = s^(x-y) + s(2y-x)$ ，得 $y = \frac{y_0}{s(2-s)}+\frac{1-s}{2-s}x$

当 x = 2y ：代入上式，得 $y_0 = s^2y$ ，$y = y_0/s^2$



故进行类推：若 x = ay ，那么 $y = \frac{f_0}{s^a} = \frac{y_0}{s^{x/y}}$ ，利用微积分知识可知 y 是一条上凸的曲线，且当 $y_0$ 变大，曲线将上移、变陡；当 s 变大，y 将减小，曲线变平



### 模型解释

若甲方增加经费保护及疏散工业、交通中心等目标

1. 乙方威慑值 $y_0$ 将变大
2. 乙方安全线 y 将上移
3. 平衡点 $P\to P'$ （向右上方移动）
4. $x_m'>x_m , y_m'>y_m$

说明甲方的被动防御也会使双方军备竞赛升级



若甲方将固定核导弹基地改进为可移动发射架

1. 乙方安全线 y 不变，同时甲方残存率变大，威慑值 $x_0$ 不变
2. x 减小，甲方安全线 x = g(x) 向 y 轴靠近
3. 平衡点 $P\to P'$ （向左下方移动）
4. $x_m'<x_m , y_m'<y_m$

说明甲方这种单独行为会使双方的核导弹数目减少



若双方发展多弹头导弹，每个弹头可以独立地摧毁目标（x, y 仍为双方核导弹的数量）

1. 双方威慑值 $x_0$ ， $y_0$ 和残存率 s 均将减小
2. 由于 $y_0$ 减小，将使 y 下移且变平，但 s 变小，将使 y 增加且变陡

所以新的平衡点 P' 会在左下方或是在右上方需要更多信息及更加详细的分析



### 天气预报的评价

| 日期 | 预报A（%） | 预报B（%） | 预报C（%） | 预报D（%） | 实测（有雨=1，无雨=0） |
| :--: | :--------: | :--------: | :--------: | :--------: | :--------------------: |
|  1   |     90     |     30     |     90     |     60     |           1            |
|  2   |     40     |     30     |     50     |     80     |           1            |
|  3   |     10     |     30     |     20     |     10     |           0            |
|  4   |     80     |     30     |     50     |     10     |           0            |



#### 计数模型

认为明天有雨概率 $\geq50\%$ 为预报有雨；

认为明天有雨概率 $\leq50\%$ 为预报无雨；

认为概率 = 50% 时，毫无意义，不予统计



同时从实用角度看，更重要的是误报率，当预报有雨而实测无雨的概率为 P1 时，将造成预防费用浪费；当预报无雨而实测有雨的概率为 P2 时，将造成预防不足导致损失



综上来看，该模型的缺点在于未考虑预报概率的具体数值



####记分模型-模型1

将预报有雨概率与实测结果比较并记分

当实测有雨，且预报有雨概率 > 0.5 时，得到相应的正分；若预报有雨概率 < 0.5 时，得到相应的负分

假定 $p_k$ 为第 k 天预报有雨概率，$v_k = 1$ 表示第 k 天有雨， $v_k =0$ 表示第 k 天无雨

那么第 k 天的预报得分应该为

$$s_k=\begin{cases} p_k-0.5,&v_k=1\\0.5-p_k,&v_k=0\end{cases}$$

对每一天的得分求和得到预报分数 S1 ， S1 越大越好；但仍有缺陷



#### 记分模型-模型2

假定 $p_k$ 为第 k 天预报有雨概率，$v_k = 1$ 表示第 k 天有雨， $v_k =0$ 表示第 k 天无雨

并认为第 k 天的预报得分为 $s_k = |p_k-v_k|$ （由于实测的结果只有 1 和 0 ，对于 $p_k$ 越接近于两端时将越有效），对 k 求和得到预报的分数 S2 ， S2 越小越好



==模型 1 和 2 对 4 种预报的优劣排序、相对方差都是相同的，即等价的（原因在于都是线性评价得分）==



#### 记分模型-模型3

假定第 k 天的预报得分为 $s_k=(p_k-v_k)^2$ 

对 k 求和得到预报的分数 S3 ， S3 越小越好；相较于 模型2 方法，该方法的优点在于，能够使得分更加合理，比如当预报 90% 有雨，实测有雨时，此方法得分为 0.81 ，相较于模型 2 的 0.9 得分小，同时直观感受 90% 的预报也是很准确的，故更好地反应预报得分



#### 对标模型 3 和模型 2 的优劣

若存在理论上的有雨概率 f ，即 P(v=1) = f ， P(v=0) = 1 - f

那么模型 3 的期望分数为

$$E(S) = E[(p-v)^2]=f(p-1)^2+(1-f)p^2 =f(1-f)+(p-f)^2$$

上式当 p = f 时取最小值



由于类似于模型 3 ，指数若为 n 时，得分为 $S=(|p-v|)^n$ ，此时求 E(S) 的极值

仅当 n = 2 时， p = f 才能使 E(S) 最小，此意义下模型 3 最佳



#### 图形模型-模型1

在 xoy 坐标轴上绘制 v = 0 和 v = 1 两条水平线，x 轴上按照概率划分间隔；在两条水平线上按照预报的概率描点，若最终图形在 v = 0 上的点靠近左端， v = 1 上的点靠近右端，那么说明预测结果较优



#### 图形模型-模型2

设 p 为预报有雨的概率， q 为实测有雨天数比例；那么当 p 和 q 接近时说明预测效果好，在 poq 坐标轴上表示为当离对角线接近时，预测效果好

但该模型对于预报 B 方法不能适用（原因在于 B 方法每次预报概率都相同，且等于实测下雨天数与总天数的比值），且由于数据量较小，不能使 D 方法得到正确评价



#### 深入讨论

##### 第一类标准

==预报者本身的一致性==：指预报者根据知识、信息和经验对预报的事件作出的判断，与他对外发布的预报之间的关系

产生不一致的原因： 1. 预报者没有利用全部判断，只从使用者的需要出发； 2. 处于预报效益考虑，对判断作出了改变

##### 第二类标准

==根据预报和实测间的关系，评价预报的品质==

##### 第三类标准

==利用预报所实现的效应或带来的费用==：利用决策分析法估计预报的效益或带来的期望值，与不用预报相比



## 简单的优化模型（静态优化）

静态优化问题指==最优解是数==（不是函数）；建立静态优化模型的关键之一是根据建模目的确定恰当的==目标函数==；求解静态优化模型一般用==微分法==

### 存贮模型（不允许缺货模型）

配件厂为装配线生产若干种产品，轮换产品时因更换设备要付生产准备费，产量大于需求时要付贮存费，该厂生产能力非常大，即所需数量可在很短时间内产出。已知某产品日需求量 100 件，生产准备费 5000 元，贮存费每日每件 1 元，试安排该产品的生产计划，即多少天生产一次（生产周期），每次产量多少，使总费用最小

要求：不只是回答问题，而且要建立生产周期、产量与需求量、准备费、贮存费之间的关系



####问题分析与思考

1. 每天生产一次，每次 100 件，无贮存费，准备费每日 5000 元
2. 10 天生产一次，每次 1000 件，贮存费为 900 + 800 + ... + 100 = 4500 元，准备费 5000 元，总计 9500 元，每天费用 950 元
3. 50 天生产一次，每次 5000 件，贮存费 4900 +4800 + ... 100 = 122500 元，准备费 5000 元，总计 127500 元，每天费用 2550 元

说明，周期短，产量小，贮存费少，但准备费多；周期长，产量大，贮存费多，准备费少；



#### 模型假设

1. 产品每天的需求量为常数 r
2. 每次生产准备费为 c1 ，每天每件产品贮存费为 c2
3. T 天生产一次（周期），每次生产 Q 件，当贮存量为 0 时， Q 件产品立即到来（生产时间不计）
4. 为方便起见，时间和产量都作为连续量处理



#### 建模目的

设 r , c1, c2 已知，求 T ， Q 使每天总费用的平均值最小



#### 模型建立（离散问题连续化）

贮存量表示为时间的函数 q(t) ； t = 0 表示生产 Q 件， q(0) = Q ， q(t) 以需求速率 r 递减， q(T)  = 0

可知： Q = rT

那么一周期贮存费为： $c_2\int _{0}^T q(t)dt = c_2 \frac{QT}{2}$ ， 一周期总费用为 $\tilde{C} = c_1 + c_2\frac{QT}{2} =c_1+c_2\frac{rT^2}{2}$

每天总费用的平均值为： $C(T) = \frac{\tilde{C}}{T} = \frac{c_1}{T}+\frac{c_2rT}{2}$



#### 模型求解

求 T 使  $C(T) = \frac{\tilde{C}}{T} = \frac{c_1}{T}+\frac{c_2rT}{2}$ 	取 min

将上式求导，可知当 $T=\sqrt{\frac{2c_1}{rc_2}}$ 时，C 取 min ，此时 $Q=rT=\sqrt{\frac{2c_1r}{c_2}}$



#### 模型解释

#####定性分析

根据上式及自我理解定性分析：当 $c_1$ 增大时， 说明准备费变大，此时应该增大周期 T ，并且增加产量 Q；当 $c_2$ 增大时，说明贮备费变大，此时应该减小周期 T， 并且减少产量 Q ；当 r 变大时，说明需求量变大，那么产量 Q 应该增加，生产周期 T 变短



##### 敏感性分析

即对参数 $c_1$ ， $c_2$ ， r 的微小变化对 T， Q 的影响

即考虑 T 对 $c_1$ 的（相对）敏感度， $S(T, c_1) = \frac{\Delta T/T}{\Delta c_1/c_1} = \frac{dT}{dc_1}\frac{c_1}{T} = \frac{1}{2}$ ，说明 $c_1$ 增加 1% ， T 增加 0.5%

同理可知 $S(T, c_2)=-1/2$ ， $S(T, r) = -1/2$ ，说明 $c_2$ 或 r 增加 1% ， T将减少 0.5%

说明对 T 敏感性不强，当该模型存在偏差时，仍可进行使用；同样，可以考虑参数对 Q 的敏感性进行分析



#### 模型应用

$T=\sqrt{\frac{2c_1}{rc_2}}$ ， $Q=rT=\sqrt{\frac{2c_1r}{c_2}}$

对于本节开头的问题， $c_1 = 5000$ ， $c_2 = 1$ ，r = 100 ；代入可知 T = 10 天， Q = 1000 件， C = 1000元

可见 C 与前述的日均费用有差别，这是因为本函数将原本离散问题连续化处理的结果

 

### 允许缺货的贮存模型

当贮存量降到零时仍有需求 r ，出现缺货将造成损失（前一个模型假设是当贮存量降到零时， Q 件立即生产出来或立即到货）

现假设：允许缺货，每天每件缺货损失费 c3 ，缺货需要不补足

那么对于周期 T ， $t= T_1$ 时贮存量降到零

一周期的贮存费 $c_2\int_0^{T_1}q(t)dt=c_2A=c_2\frac{QT_1}{2}$

一周期的缺货费 $c_3\int_{T_1}^T|q(t)|dt=c_3B=c_3\frac{r(T-T_1)^2}{2}$

所以一周期的总费用为 $\overline{C} = c_1+c_2\frac{QT}{2}+c_3\frac{r(T-T_1)^2}{2}$

所以每天总费用平均值 $C(T,Q)=\frac{\overline{C}}{T}=\frac{c_1}{T}+\frac{c_2Q^2}{2rT}+\frac{c_3(rT-Q)^2}{2rT}$ ，为保证 C 取最小值，故求偏导，使 $\frac{\partial C}{\partial T} = 0$ ，$\frac{\partial C}{\partial Q} = 0$

为避免与不允许缺货模型符号相同，故将 T 记为 T' , Q 记为 Q'

$T'=\sqrt{\frac{2c_1}{rc_2}\frac{c_2+c_3}{c_3}}$ ，$Q'=\sqrt{\frac{2c_1r}{c_2}\frac{c_3}{c_2+c_3}}$ ==注意：缺货需补足==

$Q'$ 为每周期初的存贮量，而对于每周期的生产量 R （或称为订货量） $R = rT'=\sqrt{\frac{2c_1r}{c_2}\frac{c_2+c_3}{c_3}}$ , $R=\mu Q>Q$ ，Q 为不允许缺货时的产量（或称为订货量）



#### 对比

允许缺货模型

$T'=\sqrt{\frac{2c_1}{rc_2}\frac{c_2+c_3}{c_3}}$ ，$Q'=\sqrt{\frac{2c_1r}{c_2}\frac{c_3}{c_2+c_3}}$

不允许缺货模型

$T=\sqrt{\frac{2c_1}{rc_2}}$ ， $Q=rT=\sqrt{\frac{2c_1r}{c_2}}$

将 $\mu=\sqrt{\frac{c_2+c_3}{c_3}}$ ，那么 $T'=\mu T$ ， $Q'=\frac{Q}{\mu}$

根据 $\mu$ 的表达式，可以得知 $\mu > 1$ ，故 $T' > T$ ， $Q' < Q$ ；若当 $c_3$ 增大时，此时 $\mu$ 将变小，若 $c_3\to\infty$ 时，那么 $\mu\to1$ ，此时 $T'\to T$ ， $Q'\to Q$



### 血管分支

问题：研究在能量最小原则下，血管分支处粗细血管半径比例和分岔角度



#### 模型假设

1. 一条粗血管和两条细血管在分支点对称地处于同一平面
2. 血液流动近似于粘性流体在刚性管道中的运动
3. 血液给血管壁的能量随管壁的内表面积和体积的增加而增加，管壁厚度 d 近似与血管半径 r 成正比

若设粗血管（AC）中流量为 q ，管壁厚度为 r ，运动距离为 l ，细血管（CB， CB'）中流量为 q1， 壁厚为 r1，运动距离为 l1 ，血管夹角为 $\theta$ ; B 点到粗血管中线的距离为 H ，A 点到 B 点的长度为 L

那么 q = 2q1 ，需要考虑 r/r1 及 $\theta$ 

根据流体力学，粘性流体在刚性管道中运动可知 $q=\frac{\pi r^4\Delta P}{8\mu l}$ ，其中 $\Delta p$ 为主血管 A 、 C 两点之间的压力差， $\mu$ 为粘性系数

同时根据能量公式，可知克服阻力消耗能量 $E_1 = q\Delta p = \frac{8\mu q^2l}{\pi r^4}$

由于血管还需要为人体提供能量，故设提供人体营养消耗能量为 $E_2 $ ,由于该能量应该与管壁内表面积及管壁体积有关，管壁内表面积为 $2\pi rl$ ，管壁体积为 $\pi(d^2+2rd)l$ ，根据假设，壁厚 d 应与 r 成正比；从简化角度出发，由于 $E_2$ 既与 r 的一次方有关，且与 r 的二次方有关，故设 $E_2 = br^\alpha l,1\leq \alpha \leq 2$



#### 模型建立

根据几何图形可知 $l = L-H/ \tan \theta$ ， $l_1=H/ \sin \theta$

那么粗血管和两条细血管消耗的总能量应该为 $E = E_1 + E_2=(kq^2/r^4+br^\alpha)l+(kq_1^2/r_1^4+br_1^\alpha)2l_1$ ，其中 $k = \frac{8\mu}{\pi}$

将 l 与 l1 代入可得 $E(r,r_1,\theta) = (kq^2/r^4+br^\alpha)(L-H/\tan\theta)+(kq_1^2/r_1^4+br_1^\alpha)2H/\sin\theta$



#### 模型求解

根据能量最小原理，需要求解 E 的最小能量，故对 E 的三个参数分别求偏导

$\frac{\partial E}{\partial r} = 0$ ， $\frac{\partial E}{\partial r_1} = 0$ 可知 $b\alpha r^{\alpha-1} - 4kq^2/r^5=0$ 及 $b\alpha r_1^{\alpha-1}-4kq_1^2/r_1^5=0$ ，根据前述 q = 2q1 ，最后可知 $\frac{r}{r_1} = 4^{\frac{1}{\alpha+4}}$

同时由于 $\frac{\partial E}{\partial \theta} = 0$ ，可知 $\cos \theta=2(\frac{r}{r_1})^{-4}$ ，将 r/r1 的代入可知 $\cos \theta = 2^{\frac{\alpha-4}{\alpha+4}}$

由于 $1 \leq \alpha \leq2$ ，所以 $1.26 \leq r/r_1\leq1.32$ ， $37^{\circ} \leq \theta \leq 49^{\circ}$



根据生物学家解剖试验说明：结果与观察大致吻合



#### 推论

大动脉到毛细血管假设有 n 次分岔

设大动脉半径为 $r_{max}$ ，毛细血管半径为 $r_{min}$ ，那么 $\frac{r_{max}}{r_{min}} =4^{\frac{n}{\alpha+4}}$

比如狗的血管 $r_{max} /r_{min} = 1000 \approx4^5$

那么 $ n\approx5(\alpha +4)$ ，因为 $1 \leq \alpha \leq2$ ，那么 $n\approx25-30$ ，故血管的总数大致为 $2^n\approx2^{25}-2^{30}\approx3\times 10^7-10^9$



### 冰山运输

#### 背景

1. 波斯湾地区水资源匮乏，淡化海水的成本为每立方米 0.1 英镑
2. 专家建议从 9600 km 原的南极用拖船运送冰山，取代淡化海水
3. 从经济角度研究冰山运输的可行性



#### 船舶日租金和最大运量

|      船型      |   小   |  中  |  大  |
| :------------: | :----: | :--: | :--: |
| 日租金（英镑） |  4.0   | 6.2  | 8.0  |
|    最大运量    | 5*10^5 | 10^6 | 10^7 |



#### 燃料消耗（英镑/km）

| 船速\冰山体积 | 10^5 | 10^6 | 10^7 |
| :-----------: | :--: | :--: | :--: |
|       1       | 8.4  | 10.5 | 12.6 |
|       3       | 10.8 | 13.5 | 16.2 |
|       5       | 13.2 | 16.5 | 19.8 |



####融化速率（m/天）

| 船速\与南极距离 |  0   | 1000 | >4000 |
| :-------------: | :--: | :--: | :---: |
|        1        |  0   | 0.1  |  0.3  |
|        3        |  0   | 0.15 | 0.45  |
|        5        |  0   | 0.2  |  0.6  |



#### 建模目的

选择船型和船速，使冰山到达目的地后每立方米水的费用最低，并与淡化海水的费用比较



#### 模型假设

1. 航行过程中船速不变，总距离 9600 km
2. 冰山呈球形，球面各点融化速率相同
3. 到达目的地后，每立方米可融冰 0.85 m^3 水



#### 建模分析

$船型、船速、船型\to燃料消耗、租金\to总费用$

同时船型将影响初始冰山体积，船型、船速和初始冰山体积将影响运输过程融化规律，而运输过程融化规律将影响目的地冰体积从而影响目的地水体积



#### 模型建立

##### 冰山融化规律

设船速为 u(km/h) ，与南极距离为 d(km) ，融化速率为 r (m/天)

假定 r 是 u 的线性函数，且当 d < 4000 时， u 与 d 成正比；

当 d > 4000 时， u 与 d 无关，凑出如下表达式

$$r=\begin{cases}a_1d(1+bu),&0\leq d\leq4000\\a_2(1+bu),&d>4000 \end{cases}$$

其中， $a_1=6.5\times10^{-5}$ ， $a_2=0.2$ ， $b=0.4$



那么当航行 t 天，距离 d 应为 24ut ，此时第 t 天的融化速率应为

$$r_t=\begin{cases}1.56\times10^{-3}u(1+0.4u)t,&0\leq t \leq\frac{1000}{6u}\\0.2(1+0.4u),&t>\frac{1000}{6u}\end{cases}$$



当冰山初始半径为 $R_0$ ，航行 t 天时半径为 $R_t=R_0-\sum\limits_{k=1}^{t}r_k$

冰山初始体积 $V_0=\frac{4\pi}{3}R_0^3$ ，那么第 t 天的体积为 $V_t=\frac{4\pi}{3}R_t^3$

对于选定的 u ，$V_0$ ，航行 t 天的冰山体积应为 

$$V(u,V_0,t) =\frac{4\pi}{3}((\frac{3V_0}{4\pi})^{1/3}-\sum\limits_{k=1}^tr_k)^3$$

总航行天数应为 $T=9600/24u=400/u$

故到达目的地时冰山体积应为

$$V(u,V_0) =\frac{4\pi}{3}((\frac{3V_0}{4\pi})^{1/3}-\sum\limits_{k=1}^Tr_i)^3$$



##### 燃料消耗

设燃料消耗为 $q_1(英镑/km)$ ， $q_1$ 应该对 u 是线性的，对 lgV 是线性的

故 $q_1=c_1(u+c_2)(lgV+c_3)$ ，其中 $c_1=0.3$ ， $c_2=6$ ，$c_3=-1$

那么对于选定 u ， $V_0$ 航行第 t 天燃料消耗 q (英镑/天)应为

$$q(u,V_0,t)=24u\cdot c_1(u+c_2)[lgV(u,V_0,t)+c_3]=7.2u(u+6)[lg\frac{4\pi}{3}((\frac{3V_0}{4\pi})^{1/3}-\sum\limits_{k=1}^tr_k)^3-1]$$

燃料消耗总费用为 $Q(u,V_0)=\sum \limits_{t=1}^Tq(u,V_0,t)$



##### 运送每立方米水费用

冰山初始体积 $V_0$ 的日租金 $f(V_0)$ 英镑，航行天数 $T=\frac{400}{u}$ ，故拖船租金费用 $R(u,V_0)=f(V_0)\cdot\frac{400}{u}$



故冰山运输总成本为 $S(u,V_0)=R(u,V_0)+Q(u,V_0)$

到达目的地时冰山体积 $$V(u,V_0) =\frac{4\pi}{3}((\frac{3V_0}{4\pi})^{1/3}-\sum\limits_{k=1}^Tr_i)^3$$

冰山到达目的地后得到的水体积 $W(u,V_0)=0.85V(u,V_0)$

运送每立方米水费用 $Y(u,V_0)=\frac{S(u,V_0)}{W(u,V_0)}$



#### 模型求解

求 u 和 V0 使 Y(u, V0) 最小，由于 V0 只能取离散值，同时经验公式很粗糙，故只取几组 u 和 V0 用枚举法计算

大致当 u = 4 - 5(km/h) ，$V_0=10^7(m^3)$ 时， $Y(u,V_0)$ 取最小值，此时大约为 0.065 英镑/m^3



虽然 0.065 英镑略低于淡化海水的成本 0.1 英镑，但是模型假设和构造非常简化和粗糙，同时未考虑航行过程中各种不利因素，故应当计算的 Y 值显著低于淡化海水成本时，才考虑其可行性



## 数学规划模型

线性规划、非线性规划、整数规划



### 奶制品的生产和销售

#### 企业生产计划

##### 空间层次

工厂级：根据外部需求和内部设备、人力、原料等条件，以最大利润为目标制订产品生产计划；

车间级：根据生产计划、工艺流程、资源约束及费用参数等，以最小成本为目标制订生产批量计划



##### 空间层次

若短时间内外部需求和内部资源等不随时间变化，可制订==单阶段生产计划（本节讨论）==，否则应制订多阶段生产计划



#### 例1 : 加工奶制品的生产计划

若加工 1 桶牛奶成 A1 产品，需要 12 h ，能得到 3 kg ，并且每千克获利为 24/kg ；

若加工 1 桶牛奶成 A2 产品，需要 8 h ，能得到 4 kg ，并且每千克获利为 16/kg ；

现有 50 桶牛奶，时间为 480 h ，至多加工 A1 产品 100 kg

问题1：需要制订计划，使每天获利最大？

问题2：若 35 元可买到 1 桶牛奶，买吗？若买，每天卖多少？

问题3：可聘用临时工人，付出的工资最多是每小时几元？

问题4：A1 的获利增加到 30 元/kg ，应否改变生产计划？



决策变量： x1 桶牛奶生产 A1 ， x2 桶牛奶生产 A2

目标函数： max z = 72 x1 + 64 x2

约束条件：x1 + x2 <= 50; 12x1 + 8x2 <= 480; 3x1 <= 100; x1 >= 0; x2 >= 0



##### 模型分析与假设

比例性：认为 $x_i$ 对目标函数及约束条件的贡献与 $x_i$ 取值成正比；在本例中，即认为 A1 ， A2 每千克的获利是与各自产量无关的常数，同时每桶牛奶加工 A1 , A2 的数量、时间是与各自产量无关的常数

可加性：认为 $x_i$ 对目标函数及约束条件的贡献与 $x_i$ 取值无关；在本例中，即认为 A1 ， A2 没千克的获利是与互相产量无关的常数，同时每桶牛奶加工 A1 ， A2 的数量、时间是与相互产量无关的常数

连续性：认为 $x_i$ 取值连续；在本例中，即认为加工 A1 , A2 的牛奶桶数是实数



##### 模型求解

使用 Lingo 软件求解

Model:
max = 72 * x1 + 64 * x2;
[milk] x1 + x2 <= 50; 
[time] 12 * x1 + 8 * x2 <= 480;
[A1] 3 * x1 <= 100;
end

>   Global optimal solution found.
>   Objective value:                              3360.000
>   Infeasibilities:                              0.000000
>   Total solver iterations:                             2
>
>   Model Class:                                        LP
>
>   Total variables:                      2
>   Nonlinear variables:                  0
>   Integer variables:                    0
>
>   Total constraints:                    4
>   Nonlinear constraints:                0
>
>   Total nonzeros:                       7
>   Nonlinear nonzeros:                   0
>
> ```c
>                             Variable           Value        Reduced Cost
>                                   X1        20.00000            0.000000
>                                   X2        30.00000            0.000000
>                                         // 表示剩余资源        // 表示在最优解条件下，资源增加 
>                                                               // 1 个单位，效益增加多少；或
>                                                               // 者说是购买该资源 1 个单位成
>                                                               // 本小于该值时，是可行的
>                                  Row    Slack or Surplus      Dual Price
>                                    1        3360.000            1.000000
>                                 MILK        0.000000            48.00000
>                                 TIME        0.000000            2.000000
>                                   A1        40.00000            0.000000
> ```
>

'[]' 中是为该行命名，方便在结果中查找；故最终 A1 使用 20 桶牛奶， A2 使用 30 桶牛奶



故前述问题中，35 元 < 48 元，故应该购买；并且对于工人，每小时可以提供 2 元薪资



同时， ==Lingo 还能完成敏感性分析==

>  Ranges in which the basis is unchanged:
>
> ```c
>                                    Objective Coefficient Ranges:
> 
>                                     Current        Allowable        Allowable
>                   Variable      Coefficient         Increase         Decrease
>                         X1         72.00000         24.00000         8.000000
>                         X2         64.00000         8.000000         16.00000
> 
>                                        Righthand Side Ranges:
> 
>                                     Current        Allowable        Allowable
>                        Row              RHS         Increase         Decrease
>                       MILK         50.00000         10.00000         6.666667
>                       TIME         480.0000         53.33333         80.00000
>                         A1         100.0000         INFINITY         40.00000
> ```
>

Objective Coefficient Ranges 指最优解不变时目标函数系数的允许变化范围（此时约束条件不变），本例中， x1 系数范围为 (64, 96) ； x2 系数范围为 (48, 72) ；故对于 A1 获利增加到 30元/kg ，系数为 30 * 3 = 90 仍在允许范围内

 Righthand Side Ranges 指影子价格不变时，约束条件可以变化的范围，如可以购进 10 桶牛奶，此时的影子价格仍为 48 元，但若超过 10 桶，影子价格将不明确，需要重新求解，但在 10 桶以内时可以保证获利



### 约束优化的简单分类

线性规划（LP）：目标和约束均为线性函数

非线性规划（NLP）：目标或约束中存在非线性函数；包括二次规划（QP），即目标为二次函数，约束为线性

整数规划（IP）：决策变量（全部或部分）为整数

1. 整数线性规划（ILP），整数非线性规划（INLP）
2. 纯整数规划（PIP），混合整数规划（MIP）
3. 一般整数规划， 0-1 （整数）规划



## 微分方程模型

###动态模型

1. 描述对象特征随时间（空间）的演变过程
2. 分析对象特征的变化规律
3. 预报对象特征的未来性态
4. 研究控制对象特征的手段



### 微分方程建模

1. 根据函数及其变化率之间的关系确定函数
2. 根据建模目的和问题分析作出简化假设
3. 按照内在规律或用类比法建立微分方程



### 传染病模型

#### 背景与问题

1. 描述传染病的传播过程
2. 分析受感染人数的变化规律
3. 预报传染病高潮到来的时刻
4. 预防传染病的手段



#### 基本方法

不是从医学角度分析各种传染病的特殊机理，而是按照传播过程的一般规律建立数学模型



#### 模型1

设已感染的人数（病人）为 $i(t)$

假设病人每天有效接触（足以使人致病）人数为 $\lambda$

那么建立模型 $i(t+\Delta t)-i(t)=\lambda i(t)\Delta t$ ，即为 $\frac{di}{dt}=\lambda i$ ，那么 $i(t)=i_0e^{\lambda t}$ ，且 $i(0) = i_0$ ，但当 $t\to \infty$ 时， $i\to\infty$ ，这明显是==有问题==的

问题在于病人每天接触的人并不都是正常人，若有效接触病人，则不能使病人数增加



#### 模型2—— SI 模型

区分已感染者（病人）和未感染者（健康人）

假设：

1. 总人数 N 不变，病人和健康人的比例分别为 $i(t)$ ， $s(t)$
2. 每个病人每天有效接触人数为 $\lambda$ ，且使接触的健康人都得病

那么可以建立模型 $N[i(t+\Delta t)-i(t)]=[\lambda s(t)]Ni(t)\Delta t$ ，微分后得 $\frac{di}{dt} = \lambda si$ ，且 $s(t)+i(t) = 1$ ，代入得

$$\begin{cases} \frac{di}{dt}=\lambda i(1-i)\\i(0)=i_0 \end{cases}$$

分离变量求解后得 $i(t) = \frac{1}{1+(\frac{1}{i_0}-1)e^{-\lambda t}}$

存在 t = tm ，使 $di/dt$ 达到最大值， tm 为传染病高潮到来时刻

因为 $di/dt$ 达到最大值时， i 应该为 1/2 ，所以可以求得相应的 tm 为 $t_m=\lambda^{-1}\ln(\frac{1}{i_0}-1)$

但当 $\lambda $ 减小时， $t_m$ 会增大，但只能延后传染病爆发时间，并不能真正反映实际情况（实际情况应该是控制在一定范围内，并不会爆发）



#### 模型3—— SIS 模型

传染病无免疫性——病人治愈为健康人，健康人可再次被感染

增加假设：病人每天治愈的比例为 $\mu$ ，即日治愈率

建模： $N[i(t+\Delta t)-i(t)]=\lambda Ns(t)i(t)\Delta t-\mu Ni(t)\Delta t$

可知 $\begin{cases} \frac{di}{dt}=\lambda i(1-i)-\mu i=-\lambda i[i-(1-\frac{1}{\sigma})]\\i(0)=i_0 \end{cases}$

其中， $\sigma=\lambda/\mu$ ，$\lambda$ 为日感染率； $1/\mu$ 为感染期；那么 $\sigma$ 为一个感染期内每个病人有效接触人数，称为==接触数==

通过绘图并分类讨论可知， $i(\infty) = \begin{cases}1-\frac{1}{\sigma},&\sigma>1\\0, &\sigma \leq 1  \end{cases}$

同时根据图像可知，当 $\sigma > 1$ ， $i_0<1-1/\sigma$ 时， $i(t)$ 将按 S 形曲线增长



此时，当 $\sigma \leq 1$ 时， $i(t)$ 将单调下降，说明感染期内有效接触使健康者感染的人数不超过原有的病人数



#### 模型4—— SIR 模型

传染病有免疫性——病人治愈后即移出感染系统，称为移出者

假设：

1. 总人数 N 不变，病人、健康人和移出者的比例分别为 $i(t)$ ， $s(t)$ ， $r(t)$
2. 病人的日接触率为 $\lambda$ ，日治愈率为 $\mu$ ，接触数为 $\sigma=\lambda/\mu$

可知：$s(t) + i(t) + r(t) = 1$

但仍需建立 $i(t)$ ， $s(t)$ ， $r(t)$ 的两个方程



$N[i(t+\Delta t)-i(t)]=\lambda Ns(t)i(t)\Delta t-\mu Ni(t)\Delta t$

$N[s(t+\Delta t)-s(t)]=-\lambda Ns(t)i(t)\Delta t$

求导后得

$$\begin{cases} \frac{di}{dt}=\lambda si-\mu i\\\frac{ds}{dt}=-\lambda si\\i(0)=i_0,s(0)=s_0 \end{cases}$$

其中 $i_0+s_0\approx1$ （通常 $r(0)=r_0$ 很小）

对于上述式子无法求出 $i(t)$ 和 $s(t)$ 的解析解；==但可以先做数值计算，再在相平面上研究解析解性质==



若消去 dt （上下两式相除）可得 $\frac{di}{ds}=\frac{1}{\sigma s}-1$ 及 $i|_{t=t_0}=i_0$

求解相轨线为 $i(s)=(s_0+i_0)-s+\frac{1}{\sigma}\ln \frac{s}{s_0}$ ,可知相轨线 $i(s)$ 的定义域 $D={(i,s)|s\geq0,i\geq0,s+i \leq1}$



由于 $s(t)$ 是单调递减的，说明相轨线方向始终往左

存在 $s = 1/\sigma$ 使 i 取极值 $i_m$ ，同时当 $t\to \infty$ 时， $i\to 0$ ，且 $s_{\infty} $ 满足 $s_0+i_0-s_{\infty}+\frac{1}{\sigma}\ln\frac{s_{\infty}}{s_0}=0$

说明，若初始 $s_0 > 1/\sigma$ ，那么 $i(t)$ 将先上升后降至 0 ，说明传染病蔓延

若初始 $s_0<1/\sigma$， 那么 $i(t)$ 将单调降至 0 ，传染病不蔓延



#### 预防传染病蔓延的手段

根据前文，传染病不蔓延的条件的是 $s_0 < 1/\sigma$

1. 提高阈值 $1/\sigma$ ，需要降低 $\sigma(=\lambda/\mu)$ 可以通过减小 $\lambda$ （减小接触率）或提高 $\mu$ （提高治愈率）实现

   $\lambda$ 降低需要提高卫生水平， $\mu$ 增大，需要提高医疗水平

2. 降低 $s_0$ ；这并不是意味着减少健康人群数量，也不可能是增大 $i_0$ ，那么便是提高 $r_0$ ，即通过群体免疫实现



对于 $\sigma$ 的估计

$s_0+i_0-s_{\infty}+\frac{1}{\sigma}\ln\frac{s_{\infty}}{s_0}=0$ ，由于初期 $i_0$ 较小，若忽略，便可得到 $\sigma=\frac{\ln s_0-\ln s_{\infty}}{s_0-s_{\infty}}$



#### 被传染人数的估计

记被传染的人数比例为 $x=s_0-s_{\infty}$

根据 $s_0+i_0-s_{\infty}+\frac{1}{\sigma}\ln\frac{s_{\infty}}{s_0}=0$ ,并假定 $i_0 = 0$ ，$s_0=1$ ，可得 $x+\frac{1}{\sigma} \ln(1-\frac{x}{s_0})=0$

若当 $x << s_0$ 时，可用泰勒级数展开上式，到平方项为止，那么 $x(1-\frac{1}{s_0\sigma}-\frac{x}{2s_0^2\sigma})\approx0$

可变化为 $x\approx2s_0 \sigma(s_0-\frac{1}{\sigma})$

设 $s_0-1/\sigma=\delta$ ，若当 $\delta$较小时，那么 $s_0\sigma\approx1$ ，那么 $x\approx2\delta$

从上式可知，若提高阈值 $1/\sigma$ ，可以降低被传染人数比例 x



####分析

模型 3， 4 ：描述传播过程，分析变化规律，预报高潮时刻，预防蔓延手段

模型 4 ：数值计算与理论分析相结合



### 正规战和游击战

#### 一般模型

设甲方兵力为 $x(t)$ ，乙方兵力为 $y(t)$

模型假设：

1. 每方战斗减员率取决于双方的兵力和战斗力
2. 每方非战斗减员率与本方兵力成正比
3. 甲乙双方的增员率为 $u(t)$ ， $v(t)$

模型：

$$\begin{cases} \dot{x}(t)=f(x, y)-\alpha x+u(t),&\alpha>0\\\dot{y}(t)=g(x,y)-\beta y+v(t),&\beta>0 \end{cases}$$

f ， g 取决于战争类型，分别为两方的战斗减员率； $\alpha$ 和 $\beta$ 为非战斗减员率



####正规战争模型（双方均以正规部队作战）

此时甲方的战斗减员率只取决于乙方的兵力和战斗力

$f(x,y)=-ay$ ，式中 a 表示乙方每个士兵的杀伤率

$a=r_yp_y$ ，$r_y$ 表示射击率， $p_y$ 表示命中率

同理， $g=-bx$ ， $b=r_xp_x$

若忽略非战斗减员且假设没有增援，那么 $\begin{cases} \dot{x}=-ay\\\dot{y}=-bx\\x(0)=x_0,y(0)=y_0 \end{cases}$

由于只需要判断战争的结局，不需要求 $x(t)$ 和 $y(t)$ ，而在相平面上讨论 x 与 y 的关系

故上式中的微分式相除可得 $\frac{dy}{dx}=\frac{bx}{ay}$ ，积分得 $ay^2-bx^2=k$ ，且 $k=ay_0^2-bx_0^2$

当 k > 0 时，若 x = 0 ，那么 y > 0 , 说明乙方胜利

且若 k  > 0 ,那么 $\frac{y_0}{x_0}>\frac{b}{a}=\frac{r_xp_x}{r_yp_y}$ ==称为平方率模型==

若 k < 0 ，那么相反，甲方胜利； k = 0 ，则为平局



#### 游击战争模型（双方都用游击部队作战）

甲方战斗减员率还随着甲方兵力的增加而增加

$f(x,y)=-cxy$ ，c 表示乙方每个士兵的杀伤率

$c=r_yp_y$ ， $r_y$ 表示射击率， $p_y$ 表示命中率

$p_y=\frac{s_{ry}}{s_x}$ ，$s_x$ 表示甲方活动面积， $s_{ry}$ 表示乙射击有效面积

同理，$g(x,y)=-dxy$ ， $d=r_xp_x=r_xs_{rx}/s_y$ 

若忽略非战斗减员，且假设没有增援

$\begin{cases} \dot{x}=-cxy\\\dot{y}=-dxy\\x(0)=x_0,y(0)=y_0 \end{cases}$

两式相除可得 $\frac{dy}{dx}=\frac{d}{c}$ ，化简得 $cy-dx=m$ ，且 $m=cy_0-dx_0$

若 m > 0 ,由于 x = 0 时， y  > 0 ，说明此时乙方胜利，同时 $\frac{y_0}{x_0}>\frac{d}{c}=\frac{r_xs_{rx}s_x}{r_ys_{ry}s_y}$ ==称为线性率模型==

若 m < 0 ,相反，甲方胜利；若 m = 0 ，平局



####混合战争模型（甲方为游击部队，乙方为正规部队）

此时$\begin{cases} \dot{x}=-cxy\\\dot{y}=-bx\\x(0)=x_0,y(0)=y_0 \end{cases}$

积分得 $cy^2-2bx=n$ ，且 $n=cy_0^2-2bx_0$

当 n > 0 时，乙方取得胜利，此时 $(\frac{y_0}{x_0})^2>\frac{2b}{cx_0}=\frac{2r_xp_xs_x}{r_ys_{ry}x_0}$

若假设 $x_0 = 100$ ， $r_x/r_y=1/2$ ， $p_x=0.1$ ， $s_x=1(km^2)$ ， $s_{rx}=1(m^2)$

那么此时 $(y_0/x_0)^2>100$ ，说明乙方若需要打败甲方，此时初始人数需要为甲方初始人数的 10 倍，即 1000 人



### 香烟过滤嘴的作用

####问题：

1. 过滤嘴的作用与它的材料和长度有什么关系
2. 人体吸入的毒物量与哪些因素有关，其中什么因素影响大，什么因素影响小？



####模型分析：

1. 分析吸烟时毒物进入人体的过程，建立吸烟过程的数学模型
2. 设想一个 "机器人" 在典型环境下吸烟，吸烟方式和外部环境在整个过程中不变



#### 模型假设

1. 设 l1 为烟草长度， l2 为过滤嘴长度，总长 l = l1 + l2 ；毒物量 M 均匀分布，密度 w0 = M / l1
2. 点燃处毒物随烟雾进入空气和沿香烟穿行的数量比是 a' ： a ， a' + a = 1
3. 未点燃的烟草和过滤嘴对随烟雾穿行的毒物的（单位时间）吸收率分别是 b 和 $\beta$
4. 烟雾沿香烟穿行速度是常数 v ，香烟燃烧速度是常数 u ， v >> u



#### 定性分析

设 Q 为吸一支烟毒物进入人体总量

那么当 $\beta \uparrow$ 、 $l_2\uparrow$ 、 $M\downarrow$ 、 $a\downarrow$ 、 $v\downarrow$ 时， $Q\downarrow$

当 b 、 $l_1$ 、和 u 变化时， Q 如何变化需要进行定量分析才能确定



#### 模型建立

当 t = 0 且 x = 0 时，点燃香烟

设毒物流量为 $q(x,t)$ ，毒物密度为 $w(x,t)$ ，当 t = 0 时，毒物密度相同，故 $w(x,0)=w_0$

由于吸入人体的毒物只与 x = l 处的毒物流量有关，可知 $Q=\int_0^Tq(l,t)dt$ ，其中 $T=l_1/u$



为求流量密度，设 $q(x,0)=q(x)$ ，根据流量守恒

$$q(x)-q(x+\Delta x)=\begin{cases} bq(x)\Delta \tau,&0\leq x \leq l_1\\\beta q(x)\Delta \tau,&l_1 \leq x \leq l \end{cases}$$

根据微段法，可得如上式子，该式说明了微段两端的毒物流量变化量，其中 $\Delta \tau=\Delta x/v$

代入可得

$$\frac{dq}{dx}=\begin{cases}-\frac{b}{v}q(x),&0 \leq x \leq l_1 \\ -\frac{\beta}{v}q(x)m&l_1 \leq x \leq l  \end{cases}$$

上式的初始条件是 $q(0) = aH_0$ 及 $H_0=aw_0$ ，即 x = 0 时，香烟端头的毒物流量为 $H_0$ ,但只有 a 部分流入香烟，同时由于速度和密度已知，故可表示 $H_0$

故求解得

$$q(x)=\begin{cases}aH_0e^{-\frac{bx}{v}}, 0 \leq x \leq l_1\\aH_0e^{-\frac{bl_1}{v}}e^{-\frac{\beta(x-l_1)}{v}},&l_1 \leq x \leq l  \end{cases}$$



求 t 时刻 l 处的毒物流量 $q(l,t)$ ，此时香烟燃至 x = ut

与上述推论进行类比，只要知道 x = ut 处的毒物流量 H(t) ，并假定此处为始点，那么便可推出类似的公式

$H_0\implies H(t)=uw(ut,t)$ ，$x \implies x-ut(ut \leq x \leq l_1)$ ， $l_1 \implies l_1-ut(l_1 \leq x \leq l)$

此时类似公式为

$$q(x)=\begin{cases}aH(t)e^{-\frac{b(x-ut)}{v}}, ut \leq x \leq l_1\\aH(t)e^{-\frac{b(l_1-ut)}{v}}e^{-\frac{\beta(x-l_1)}{v}},&l_1 \leq x \leq l  \end{cases}$$

此时 $q(l,t)=auw(ut,t)e^{-\frac{b(l_1-ut)}{v}}e^{-\frac{\beta l_2}{v}}$

此时，便将问题转化求解 w(ut, t)



#####求 $w(ut,t)$

通过考察 $\Delta t $ 内毒物密度的增量

$$w(x,t + \Delta t)-w(x,t)=b\frac{q(x,t)}{v}\Delta t$$ ，即单位长度烟雾毒物被吸收部分

由于 $$q(x)=aH(t)e^{-\frac{b(x-ut)}{v}}$$ ,且$ H(t)=uw(ut,t)$  ，对 t 求偏微分得

$$\frac{\partial w}{\partial t}=\frac{b}{v}auw(ut,t)e^{-\frac{b(x-ut)}{v}}$$ 且 $w(x,0) =w_0$

求得 $w(ut,t)=\frac{w_0}{a'}(1-ae^{-\frac{a' but}{v}})$ 



##### 计算 Q

将 $w(ut,t)$ 代入到 $q(l,t) $ 中，得 $q(l,t)=\frac{auw_0}{a'}e^{\frac{bl_1}{v}}e^{-\frac{\beta l_2}{v}}(e^{-\frac{but}{v}}-ae^{-\frac{abut}{v}})$

对 q 积分，可得 $Q = \int_0^{l_1/u}q(l,t)dt=\frac{aw_0v}{a'b}e^{-\frac{\beta l_2}{v}}(1-e^{-\frac{a'bl_1}{v}})$

$$Q=aMe^{-\frac{\beta l_2}{v}}\varphi(r)$$ ，其中 $r=\frac{a'bl_1}{v}$ ， $\varphi(r)=\frac{1-e^{-r}}{r}$



#### 结果分析

1. Q 与 a , M 成正比， aM 是毒物集中在 x = 0 处的吸入量

2. $e^{-\frac{\beta l_2}{v}}$ 是过滤嘴因素，$\beta$ 和 $l_2$ 两者乘积对吸入量呈负指数作用

   $aMe^{-\frac{\beta l_2}{v}}$ 是毒物集中在 x = l1 处的吸入量

3. $\varphi(r)$ 是烟草的吸收作用

4. 与另一支不带过滤嘴的香烟对比，吸至 x = l1 扔掉

   $$Q_1=\frac{aw_0v}{a'b}e^{-\frac{b l_2}{v}}(1-e^{-\frac{a'bl_1}{v}})$$ 带过滤嘴 

   $$Q_2=\frac{aw_0v}{a'b}e^{-\frac{\beta l_2}{v}}(1-e^{-\frac{a'bl_1}{v}})$$ 不带过滤嘴

   $\frac{Q_1}{Q_2}=e^{-\frac{(\beta-b)l_2}{v}}$ ，因为 $\beta>b$ ，所以 $Q_1<Q_2$ ，且由于 $\beta -b$ 与 $l_2$ 都是一次，说明提高两者的效果相同



## 代数方程与差分方程模型

### CT 技术的图像重建

CT 技术：在==不同深度==的断面上，从==各个角度==用探测器接收旋转的 X 光管发出、穿过人体而使==强度衰减的射线==



#### X 射线强度衰减与图像重建的数学原理

设射线强度为 $I$ ，物质在射线方向的厚度为  $l$ ，入射强度为 $I_0$ ，物质对射线的衰减系数为 $\mu$

当物质均匀时，涉嫌强度的衰减率与强度成正比，即 $\frac{dI}{dl}=-\mu I$ ，得 $I=I_0e^{-\mu I}$

若射线沿直线 L 穿行，穿过由不同衰减系数的物质组成的非均匀物体（人体器官）时

$\mu I=\int_L\mu(x,y)dl$ ，那么 $I=I_0exp(-\int_L\mu(x,y)dl)$ ，转化得 $\int_L\mu(x,y)dl=\ln \frac{I_0}{I}$



由于上式右端数值可以通过 CT 的测量数据得到，而==图像重建==的目的便是从 $\int_L\mu(x,y)dl$ 找到被积函数 $\mu(x,y)$ ，从而根据该数值反应人体器官大小、形状、密度的图像



##### 数学原理

数学上称之为拉东变换，即 $P_f(L)=\int_Lf(x,y)dl$ 求解方法为 $f(Q)=-\frac{1}{\pi}\int_0^{\infty}\frac{dF_Q(q)}{q}$ ，即逆拉东变换

Q 即为 (x, y) ，$F_Q(q)$ 为与 Q 相距 q 的直线 L 的线积分 $P_f(L)$ 对所有 q 的平均值

但该方法只是理论情况，==实际只能在有限条直线上得到投影==



#### 图像重建的代数模型

由于上述数学原理难以实现，故将非均匀物质划分为 m 个像素，通过 n 条射线进行求解

那么对于每个像素，射线的衰减系数都是常数

$\mu_j$ 为像素 j 的衰减系数

$\Delta l_j$ 为射线在像素 j 中的穿行长度

$J(L_i)$ 为射线 $L_i$ 穿过的像素 j 的集合

$\ln(I_0/I)$ ~ Li 是通过 CT 仪器测得的强度数据

那么 $\int_L\mu(x,y)dl=\ln \frac{I_0}{I}$ 可转换为 $\sum \limits_{j \in J(L_i)}\mu_j\Delta l_j=\ln(I_0/I)_i,i=1,2,...,n$



所以需要知道在各个像素中穿行的长度 $\Delta l_j$

常用算法（将 $\ln(I_0/I) $ $b_i$ 表示， $\mu j$ 用 $x_j$ 表示）

设像素的边长和射线的宽度均为 $\sigma$ 

1. 中心线法

   采用射线的中心线穿过的长度作为穿行长度， $a_{Ij}$ 表示射线 $L_i$ 的中心线在像素 j 内的长度与 $\sigma$ 之比，那么

   $\sum \limits_{j \in J(L_i)}\mu_j\Delta l_j=\ln(I_0/I)_i=\sum \limits_{j=1}^ma_{ij}x_j=b_i,i=1,2,...,n$ ，即 $Ax=b$

2. 面积法

   $a_{ij}$ 表示为射线 $L_i$ 在像素 j 内的面积 $s_{ij}$ 与像素面积 $\sigma^2$ 之比

3. 中心法

   认为若射线中心线与像素相交便取 1 ，若不相交，则取 0



##### 中心法的简化形式（代数重建技术 ART）

假定射线的宽度为零，间距为 $\sigma$ ，若 $L_i$ 经过像素 j 内任一点，那么 $a_{ij}=1$

从而写出 A 矩阵，A 应为 n * m 阶矩阵

根据 A 和 b ，由 Ax = b 确定像素的衰减系数向量 x ，但由于像素往往划分较密，数量很大，虽然射线也较多，但一般都小于 m ，故方程将有无穷多解；此时需要考虑测量误差和噪声，即

$Ax+e=b$ ，在 x 和 e 满足的最优准则下估计 x



### 原子弹爆炸的能量估计

爆炸产生的冲击波以爆炸点为中心呈球面向四周传播，爆炸的能量越大， 在一定时刻冲击波传播得越远

冲击波由爆炸形成的蘑菇云反映出来。

泰勒通过测量数据（时刻 t 所对应的蘑菇云半径 r），并且用==量纲分析法==建立数学模型，辅以小型试验，完成对爆炸的能量进行估计



#### 量纲齐次原则

等式两端的量纲一致

量纲分析：利用量纲齐次原则寻求物理量之间的关系



#### 原子弹爆炸能量估计的量纲分析法建模

记爆炸能量为 E ，将蘑菇云近似看成一个球形

时刻 t 球的半径为 r ，r 与时间 t ，爆炸能量 E ，空气密度 $\rho$ ，大气压强 P 有关

故令 $f(r,t,E,\rho,P)=0$ ，基本量纲为 L ， M ，T

将各个参数用基本量纲表示， $[r]=L$ ； $[t]=T$ ； $[E]=L^2MT^{-2}$ ； $[\rho]=L^{-3}M$ ； $[P]=L^{-1}MT^{-2}$

得到量纲矩阵 $A_{3\times5}$为

|  1   |  0   |  2   |  -3  |  1   |  L   |
| :--: | :--: | :--: | :--: | :--: | :--: |
|  0   |  0   |  1   |  1   |  1   |  M   |
|  0   |  1   |  -2  |  0   |  -2  |  T   |
|  r   |  t   |  E   |  p   |  P   |      |



A 矩阵 rank 为 3 ，故 $Ay=0$ ， $y=(y_1,y_2,y_3,y_4,y_5)^T$ 有两个基本解， $y=(1,-2/5,-1/5,1/5,0)$ ， $y=(0,5/6,-2/5,-3/5,1)$ ，故可得到两个无量纲量

$\pi_1=rt^{-2/5}E^{-1/5}\rho^{1/5}=r(\frac{\rho}{t^2E})^{1/5}$

$$\pi_2=t^{6/5}E^{-2/5}\rho^{-3/5}P=(\frac{t^6P^5}{E^2P^3})^{1/5}$$

故 $F(\pi_1,\pi_2)=0$

可得两个无量纲量之间应满足

$$r(\frac{\rho}{t^2E})^{1/5}=\Psi (\frac{t^6P^5}{E^2P^3})^{1/5}$$

故$$r=(\frac{t^2E}{\rho})^{1/5}\Psi (\frac{t^6P^5}{E^2P^3})^{1/5}$$

由于时间 t 非常短，而能量 E 非常大，所以 $$\Psi (\frac{t^6P^5}{E^2P^3})^{1/5}\approx \Psi(0)$$

同时，泰勒根据小型爆炸试验的数据建议 $\Psi(0) \approx1$

故 $r=(\frac{t^2E}{\rho})^{1/5}$ ，同时，空气密度 $\rho=1.25(kg/m^3)$

用 r , t 的实际数据做平均，可得 $E=8.2825\times10^{13}$ 焦耳

由于 1 千吨（TNT 能量）为 $4.184*10^{12}$ 焦耳，故大致估算 E 为 19.7957 千吨 TNT



#### 模型检验

由于可通过 $r=(\frac{t^2E}{\rho})^{1/5}$ 公式，得知 r 与 t 应该是 2/5 次的关系

若用最小二乘法拟合， $r=at^b$ ，将测量的数据代入，可得 b = 0.4058 ,所以结果符合要求



### 按年龄分组的种群增长

不同年龄组的繁殖率和死亡率不同

以雌性个体数量为对象

建立差分模型，讨论稳定状况下种群的增长规律



#### 假设与建模

1. 种群按年龄大小等分为 n 个年龄组，记为 i = 1， 2， ... ， n
2. 时间离散为时段，长度与年龄组区间相等，记为 k = 1， 2，..
3. 第 i 年龄组 1 个雌性个体在 1 时段内的繁殖率为 bi
4. 第 i 年龄组在 1 时段内的死亡率为 di ，存活率为 si = 1 - di



设 $x_i(k)$ 为时段 k 第 i 年龄组的种群数量

那么 $x1(k+1)=\sum \limits_{i=1}^nb_ix_i(k)$ ,此时至少 1 个 $b_i>0$

$x_{i+1}(k+1)=s_ix_i(k),i=1,2,...,n-1$

用矩阵表示，如 $x(k)=[x_1(k),x_2(k)...x_n(k)]^T$

并且引入 Leslie 矩阵 

$$L=\begin{bmatrix}b_1&b_2&...&b_{n-1}&b_n\\s_1&0&...&0&0\\0&s_2&...&0&0\\...\\0&0&...&s_{n-1}&0 \end{bmatrix}$$

那么 $x(k+1)=Lx(k)$ ，即 $x(k)=L^kx(0)$ ，这样便可预测任意时段种群按年龄组的分布



#### 稳定状态分析的数学知识

L 矩阵存在==正单特征根== $\lambda_1$ ，$|\lambda_k| \leq \lambda_1,k=2,3,...n$

特征向量 $x^*=[1,\frac{s_1}{\lambda_1},\frac{s_1s_2}{\lambda_1^2},...,\frac{s_1s_2...s_{n-1}}{\lambda_1^{n-1}}]$

若 L 矩阵存在 $b_i,b_{i+1}>0$ ，则 $|\lambda_k|<\lambda_1,k=2,3,...,n$

且 $\lim\limits_{k\to \infty}\frac{x(k)}{\lambda_1^k}=cx^*$ ，c 是由 bi , si , x(0) 决定的常数



## 稳定性模型

### 人口的预测和控制（需要其内部分知识）

常用的计算公式：今年的人口为 $x_0$ ，年增长率为  $r$

k 年以后人口 $x_k=x_(1+r)^k$

##### 马尔萨斯指数增长模型

基本假设：人口（相对）增长率 r 是常数

设 x(t) 为时刻 t 的人口

那么 $\frac{x(t+\Delta t)-x(t)}{x(t)}=r\Delta t$ ，所以 $\frac{dx}{dt}=rx$ ， $x(0)=x_0$ ，故 $x(t)=x_0e^{rt}$ 形式与常用公式一致



##### 指数增长模型的应用和局限性

1. 与 19 世纪以前欧洲一些地区人口统计数据吻合
2. 适用于 19 世纪后前往加拿大的欧洲移民后代
3. 可用于短期人口增长预测
4. 不符合 19 世纪后多数地区人口增长规律
5. 不能预测较长期的人口增长过程

原因在于 19 世纪后，人口增长率 r 不是常数（逐渐下降）



##### 阻滞增长模型—— Logistic 模型

人口增长到一定数量后，增长率下降的原因：

资源、环境等因素对人口增长的阻滞作用，且阻滞作用随人口数量增加而变大，说明 r 是 x 的减函数

假设 $r(x)=r-sx(r,s>0)$ ，r 为固有增长率（x 很小时）， $x_m$ 设为人口容量（资源、环境能容纳的最大数量）

那么 $r(x_m)=0$ ，可得 $s=\frac{r}{x_m}$ ，代入可得 $r(x)=r(1-\frac{x}{x_m})$



故$\frac{dx}{dt}=r(x)x=rx(1-\frac{x}{x_m})$

积分可得 $x(t)=\frac{x_m}{1+(\frac{x_m}{x_0}-1)e^{-?}}$



###  捕鱼业的持续收获

设渔场鱼量为 x(t)

假设：无捕捞时鱼的自然增长服从 Logistic 规律，即 $\dot{x}(t)=f(x)=rx(1-\frac{x}{N})$

其中 r 为固有增长率， N 为最大鱼量

并且假设单位时间捕捞量与渔场鱼量成正比，故 $h(x)=Ex$ ，其中 E 为捕捞强度



#### 建模

记 $F(x)=f(x)-h(x)$

故捕捞情况下，渔场鱼量满足 $\dot{x}(t)=f(x)=rx(1-\frac{x}{N})-Ex$

问题：不需要求解 x(t) ，只需知道 x(t) 稳定的条件



#### 一阶微分方程的平衡点及其稳定性

若一阶非线性微分方程右端不含 t ，则称其为自治方程，如 $\dot{x}=F(x)$

而 $F(x)=0$ 的根 $x_0$ 被称为微分方程的平衡点



设 $x(t)$ 是方程的解，若从 $x_0$ 某领域的任一初值出发，都有 $\lim \limits_{t\to\infty}x(t)=x_0$ ，那么称 $x_0$ 是方程 $\dot{x}=F(x)$ 的稳定平衡点



不求 $x(t)$ ，判断 $x_0$ 稳定性的方法——直接法

由于 $\dot{x}=F(x)$ 的近似方程（在 x = x0 的展开式）为 $\dot{x}=F'(x_0)(x-x_0)$ ，说明 x 的导数只与某一常数 a 和 x 的乘积有关，若积分可知，x 的表达式中将有 $e^{at}$ 的项，当 a > 0 时，x 将为无穷大，不满足；故只有当 a < 0 时，此时表示 $F'(x_0)<0$ 时才能满足稳定要求



故对于原模型，先求 $F(x)=0$ 时， x 的数值，$x_0=N(1-E/r)$ ，$x_1=0$

所以，稳定性判断为 $F'(x_0)=E-r$ ， $F'(x_1)=r-E$

当 $E<r$时， $F'(x_0) <0,F'(x_1)>0$ ，说明 x0 稳定， x1 不稳定

当 $E>r$时， $F'(x_0) >0,F'(x_1)<0$ ，说明 x0 不稳定， x1 稳定

但当 x1 稳定时，可见渔场鱼量为 0 ，不满足；故只有当 x0 稳定，可得到稳定产量



#####产量模型

在捕捞量稳定的条件下，控制捕捞强度使产量最大

产量为 $h(x)=Ex$

只有当 $E<r$ 时，才能在 $x_0$ 保持稳定，说明 f 和 h 必须会有交点，但可以调整 E 的值，使 h 转动，明显，当交点为 f 的最大值时，捕捞量 h 也将达到最大值，此时需要控制渔场鱼量为最大鱼量的一半，即 N/2 ，最大捕捞量为 rN/4 ，捕捞强度为 E = r/2



##### 效益模型

在捕捞量稳定的条件下，控制捕捞强度使==效益==最大

假设鱼的销售价格为 p ，单位捕捞强度费用为 c

收入为 T = ph(x) = pEx ，支出为 S=cE

单位时间利润为 R = T - S = pEx - cE ，稳定平衡点为 $x_0=N(1-E/r)$

求 E 使 R(E) 最大，此时，$E_R=\frac{r}{2}(1-\frac{c}{pN})$ ，小于产量模型中的捕捞强度

此时渔场鱼量应为 $x=N(1-\frac{E_R}{r})$



##### 捕捞过度

上述都讨论的是封闭式捕捞，此时追求利润最大

若开放式捕捞，只追求利润 R > 0，那么根据 R = T - S = pEx - cE ，稳定平衡点为 $x_0=N(1-E/r)$

可知 $E_s=r(1-\frac{c}{pN})$

说明，当 R = 0时，捕捞强度 $E_s=2E_R$ ，此为临界强度

临界强度下的渔场鱼量 $x_s=N(1-\frac{E_s}{r})=\frac{c}{p}$

说明，此时的鱼量由成本-价格决定，当价格上升，成本下降，那么捕捞强度 $E_s$ 将变大， $x_s$ 将变小，正是过度捕捞



###食饵-捕食者模型（种群的弱肉强食）

种群甲靠丰富的天然资源生存，种群乙靠捕食甲为生，形成食饵—捕食者系统

设食饵（甲）数量 x(t) ，捕食者（乙）数量 y(t)

甲独立生存的增长率 r ，则 $\dot{x}=rx$

乙使甲的增长率减小，减小量与 y 成正比， $\dot{x}(t)=(r-ay)x=rx-axy$

乙独立生存时的死亡率为 d , $\dot{y}=-dy$

甲使乙的死亡率减小，减小量与 x 成正比，$\dot{y}(t)=-(d-bx)y=-dy+bxy$



模型的平衡点及其稳定性

由于现为方程组，若需要求平衡点便需要同时考虑 x 和 y

平衡点有 P(d/b, r/a) 和 P'(0, 0)

若对方程组求偏导，可得雅各比矩阵

$$A=\begin{bmatrix}r-ax&-ax\\by&-d+bx \end{bmatrix}$$

将 P 和 P' 两点代入，可得

$$A|_P=\begin{bmatrix}0&-ad/b\\br/a&0 \end{bmatrix}$$

可得 p = 0, q > 0 ，说明 P 处于临界状态

$$A|_P=\begin{bmatrix}r&0\\0&-d \end{bmatrix}$$

此时， q < 0 ，说明 P' 处于不稳定状态

（p 、q为特征根，若存在复数，则考虑特征根的实部）



所以 P 点稳定性不能用近似线性方程分析，需要考虑其他方法



#### 用相轨线来分析 P 点的稳定性

$\dot{x}(t)=(r-ay)x$

$\dot{y}=(-d+bx)y$

消去 dt ，可得 $\frac{dx}{dy}=\frac{x(r-ay)}{y(-d+bx)}$

分离变量， $\frac{-d+bx}{x}dx=\frac{r-ay}{y}dy$ ，所以 $-d\ln x+bx=r\ln y-ay+c_1$ ，即 $(x^de^{-bx})(y^re^{-ay})=c$ ，其中 c 可由初始条件求得

将两项分别用 f 和 g 来表示，可得 $f(x)g(x)=c$

根据表达式，可知 $f(0)=f(\infty)=0$ ,存在 $f(x_0)=f_m$  ，此时 $x_0=d/b$

同样，$g(0)=g(\infty)=0$ ,存在 $g(y_0)=g_m$  ，此时 $y_0=r/a$

可见，这两个极值坐标正好是 P 点坐标，若 $c>f_mg_m$ ，说明初值 c 过大，不存在相轨线

若 $c=f_mg_m$ ，此时 $x=x_0,y=y_0$ ，相轨线退化为 P 点

若 $c<f_mg_m$ ,设 $c=pg_m$ ，此时 $y=y_0$ ，即 $g(y)=g_m$ ，说明 $f(x)=p<f_m$

根据 f 图形，可知存在 $x_1<x_0<x_2$ ，使 $f(x_1)=f(x_2)=p$ ，即存在两个点 $Q_1(x_1,y_0)$ 和 $Q_2(x_2,y_0)$ 满足要求

当 $x\in[x_1,x_2]$ 时，$f(x)g(y)=pg_m$ ，由于 $f(x)>p$ ，所以 $g(y)=q<g_m$

此时存在 $y_1<y_0<y_2$ ，使 $g(y_1)=g(y_2)=q$ ，令点 $Q_1(x,y_1)$ 和 $Q_2(x,y_2)$ 满足要求，此时 x 为 $[x_1,x_2]$ 内任意点

说明相轨线应该为封闭曲线



并且根据分析，可知在周期内，各点 x 和 y 的坐标值的平均值应该就是 P 点的 x 和 y 值

同时根据各点导数大小，可以确定相轨线的运动方向



#### 模型解释

捕食者数量 $\overline{y}=\frac{r}{a}$ 

r 为食饵增长率， a 为捕食者掠取食饵能力

说明捕食者数量与 r 成正比，与 a 成反比（因为此时食饵数量将减少）

食饵数量 $\overline{x}=\frac{d}{b}$

d 为捕食者死亡率， b 为食饵供养捕食者能力

说明食饵数量与 d 成正比，与 b 成反比



在一次大战期间，地中海渔业的捕捞量下降，但是其中鲨鱼的比例却在增加，为什么？

由于对于自然环境条件下，均值为  $\overline{x}=\frac{d}{b}$ 和  $\overline{y}=\frac{r}{a}$ 

在捕捞条件下，r 将变为 $r-\epsilon_1$ ，而 d 将变为 $d+\epsilon_1$

此时 $\overline{x}_1>\overline{x}$ 而 $\overline{y}_1<\overline{y}$ ，说明点 P 将向右下方移动到点 P1 ，说明食饵增加，捕食者减少

但在战时条件下（与捕捞条件下相比），由于捕捞人数减少

r 将变为 $r-\epsilon_2$ ，而 d 将变为 $d+\epsilon_2$ ，$\epsilon_2<\epsilon_1$

此时 $\overline{x}_1>\overline{x}_2$ 而 $\overline{y}_1<\overline{y}_2$ ，说明点 P1 将向左上方移动到点 P2 ，说明食饵减少，捕食者增加

但 P2 点仍处于 P 点的右下方



$P\to P_1$ 还表明：对害虫（食饵）-益虫（捕食者）系统，使用灭杀两种虫的杀虫剂，会使害虫增加，益虫减少

  

#### 两种群模型的几种形式

相互竞争

$\dot{x}_1(t)=r_1x_1(1-\frac{x_1}{N_1}-\sigma_1\frac{x_2}{N_2})$

$\dot{x}_2(t)=r_2x_2(1-\sigma_2\frac{x_1}{N_1}-\frac{x_2}{N_2})$

相互依存

$\dot{x}_1(t)=r_1x_1(\pm1-\frac{x_1}{N_1}+\sigma_1\frac{x_2}{N_2})$

$\dot{x}_2(t)=r_2x_2(\pm1-\sigma_2\frac{x_1}{N_1}+\frac{x_2}{N_2})$

若肉强食

$\dot{x}_1(t)=r_1x_1(1-\frac{x_1}{N_1}-\sigma_1\frac{x_2}{N_2})$

$\dot{x}_2(t)=r_2x_2(-1+\sigma_2\frac{x_1}{N_1}-\frac{x_2}{N_2})$



### 差分形式的阻滞增长模型

连续形式的阻滞增长模型用 $x(t)$ 表示某种群 t 时刻的数量， $\dot{x}(t)=rx(1-\frac{x}{N})$

当 $t\to \infty$ 时， $x\to N$ ，==x = N 是稳定平衡点（与 r 大小无关）==

离散模型，设某种群第 k代的数量为 $y_k$

那么 $y_{k+1}-y_k=ry_k(1-\frac{y_k}{N})$

若 $y_k=N$ ，那么 $y_{k+1},y_{k+2}...$ 都将为 N



## 离散模型

### 层次分析模型

例1 等同于 Algorithm 中的层次分析法



若成对比较完全一致，满足 $a_{ij}\cdot a_{jk}=a_{ik}$ 的正互反阵 A 称一致阵

性质包括

1. A 的秩为 1 ， A 的唯一非零特征根为 n
2. A 的任一列向量是对应于 n 的特征向量
3. A 的归一化特征向量可作为权向量

对于不一致（但在允许范围内）的成对比较阵 A ，建议用对应于最大特征根 $\lambda$ 的特征向量作为权向量 w ，即 $Aw=\lambda w$



一致性检验（对 A 确定不一致的允许范围）

已知： n 阶一致阵的唯一非零特征根为 n

可证： n 阶正互反矩阵最大特征根 $\lambda \geq n$ ，且当 $\lambda =n$ 时，为一致阵

定义一致性指标： $CI=\frac{\lambda-n}{n-1}$ ，当 CI 越大，不一致越严重

为衡量 CI 的大小，引入随机一致性指标 RI ，随机模拟得到 $a_{ij}$ ，形成 A ，计算 CI 得到 RI

RI 的计算结果

| n    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| RI   | 0    | 0    | 0.58 | 0.9  | 1.12 | 1.24 | 1.32 | 1.41 | 1.45 | 1.49 | 1.51 |

一致性比率为 CR=CI/RI ,当 CR < 0.1 时，通过一致性检验



### 公平的席位分配



### 存在公平的选举规则吗

####背景与问题

群体决策——社会经济领域中用民意调查的办法决定人民大众对某些事件、政策、人物的倾向

1. 投票评选优秀电影、优秀运动员
2. 根据投票情况决定选举结果——选举规则
3. 怎样的选举规则才是公正的？公正的标准是什么？
4. 在普遍赞同的标准下是否存在公正的规则



#### 选举规则

I = {1, 2, 3, ..., n} 为选民集合

A = {x, y, z, u, ..., } 为 m 位候选人集合

选民 i 对全体候选人投票，得到 A 的一个排序 pi

根据全体候选人的投票 pi ，确定群体对 A 的一个排序 p （选举结果）

选举规则： pi 与 p 的对应关系（群体一致函数）



排序 pi 和 p 应满足个性质（公理）：

1. 对于任意的 $x,y\in A$ ，或者 x 优于 y （x > y），或者 x 等同 y (x = y) ，或者 x 劣于 y (x < y) （>= 表示优于或等同， x <= y 表示劣于或等同）
2. 对于任意的 $x,y,z\in A$ ，若 x >= y, y >= z ，则 x >= z ，且仅当 x = y ， y = z 时，才有 x = z （传递性）



##### 选举规则 1——简单多数规则

当且仅当超过半数的选民 i 投票 pi 中有 x > y 时，选举结果 p 中才有 x > y

如： I = {1, 2, 3} ， A = {x, y, u, v} 的投票为

p1：{x>y>u=v} ； p2:{y>x>u>v}; p3:{x=u>v>y}

根据上述规则，可得结果 p 为 x>y>u>v



但若为 p1: x>y>z; p2: y>z>x; p3:z>x>y

那么按照规则 p 应有 x>y, y>z, z>x ，破坏可传递性



故规则 1 使用方便，但不满足排序的可传递性



####选举规则 2——积分规则（Borda 数）

Bi(x) 表示 pi 中劣于 x 的候选人数目

$B(x)=\sum\limits_{i=1}^nB_i(x)$ ，便成为选举中的分数，即 Borda 数

当且仅当 B(x) > B(y) 时，选举结果 p 中才有 x > y

如： I = {1, 2, 3} ， A = {x, y, u, v} 的投票为

p1：{x>y>u=v} ； p2:{y>x>u>v}; p3:{x=u>v>y}

B1(x) = 3, B2(x) = 2, B3(x) = 2, B(x) = 7

同理，B(y) = 5, B(u) = 3, B(v) = 1 可得 x>y>u>v



若为 p1: x>y>z; p2: y>z>x; p3:z>x>y

B(x) = B(y) = B(z) = 3

故排序为 x = y = z



规则 2 的问题在于：投票时只要求顺序，而积分规则考虑优劣程度

如 I = {1, 2, 3, 4} ， A = {x, y, z, u, v} 的投票为

p1, p2, p3 ：x>y>z>u>v; p4: y>z>u>v>x

此时 B(x) = 12, B(y) = 13 ，可见 y > x ，违反了多数人的意愿



说明两种规则都有不满意之处，是否有适合所有情况的、公正合理的规则



#### Arrow 公理：选举规则应满足的 5 条公理

公理 1 ：选举的完全性

选民对选举的任一种排序都是允许的

公理 2 ：选举结果与选民投票的正相关性

对于投票 pi ，结果为 x > y ，若再 pi' 中，x ， y的排序相同或 x 提前，其他候选人的排序不变，那么 p' 中， x > y

公理 3 ：无关候选人的独立性

设 A1 是 A 的子集，若再 pi 和 pi' 中 A1 内候选人的排序相同，则 p 和 p' 中 A1 内候选人的排序也相同

公理 4 ：选民的主权性

对任意候选人 x , y ，存在 pi 使 x > y

公理 5 ：选民的非独裁性

不存在这样的选民 i ，使对任意的候选人 x ，y ，只要 pi 中 x > y ,选举规则就确定 p 中 x > y



若选举人只有 2 项时，满足 Arrow 公理

但若选举人至少有 3 位时，不存在满足 Arrow 公理的选举规则



## 概率模型

随机模型：确定型因素和随机性因素

当随机因素可以忽略或者随机因素影响可以简单地以平均值的作用出现时称为确定性模型

当随机因素影响必须考虑，称为随机性模型



概率模型一般使用统计回归模型和马氏链模型



### 传送系统的效率

### 背景

工人将生产处的产品挂在经过他上方的空钩上运走，若工作台数固定，挂钩数量越多，传送带运走的产品越多

当生产进入稳态后，给出衡量==传送带效率==的指标，研究提高该效率的途径



#### 问题分析

1. 进入稳态后，假定工人们的生产周期相同
2. 但每人生产完一件产品的时刻不会一致，可以认为是随机的，并且在一个周期内==任一时刻的可能性相同==
3. 每人做完一件产品后，要么恰好有空钩经过他的工作台，使他可以将产品挂上运走，要么没有空钩经过，迫使他放下这件产品并立即投入下件产品的生产



可以通过一个周期内传送带运走的产品数占产品综述的比例作为衡量传送带效率的数量指标





#### 模型假设

1. n 个工作台均匀排列， n 个工人生产相互独立，生产周期是常数
2. 生产进入稳态，每人生产一件产品的时刻在一个周期内是==等可能==的
3. 一周期内 ==m 个均匀排列的挂钩==通过每一工作台的上方，到达第一个工作台的挂钩都是空的
4. 每人在生产完一件产品时，都==能且只能触碰到一只挂钩==，若这只挂钩是空的，则将产品挂上运走；若挂钩非空，则将这件产品放下，退出运送系统



#### 模型建立

定义==传送带效率==为一周期内运走的产品数（记作 s ，待定）与生产总数 n （已知）之比，记作 D = s / n

为确定 s ，从==工人==考虑还是从==挂钩==考虑，哪个方便？

若求出一周期内每只挂钩非空的概率 p ，则 s = mp



##### 如何求概率

设每只挂钩为空的概率为 q ，则 p = 1 - q

设每只挂钩不被一工人触到的概率为 r ，则 $q=r^n$

设每只挂钩被一工人触到的概率为 u ，则 r = 1 - u

一周期内有 m 个挂钩通过每一工作台的上方， u = 1 / m

故 $p=(1-1/m)^n$

$D=m[1-(1-1/m)^n]/n$



若（一周期运行的）挂钩数 m 远大于工作台数 n ，则将原式展开为

$D\approx\frac{m}{n}[1-(1-\frac{n}{m}+\frac{n(n-1)}{2m^2})]=1-\frac{n-1}{2m}$

定义 E = 1 - D（一周期内未运走产品数与生产总数之比）

当 n 远大于 1 时， $E\approx\frac{n}{2m}$ ，说明 E 与 n 成正比，与 m 成反比

此时提高效率的途径可为：增加 m （若减少 n ，产量会减小）



### 报童的秘诀

####问题

报童售报： a（零售价）> b（购进价）> c（退回价）

售出一份赚 a-b ；退回一份赔 b-c

每天购进多少份报纸可使收入最大？



#### 分析

若购进太多，卖不完需要退回，则赔钱；若购进太少，不够销售，赚钱少，故存在一个合适的购进量

应根据需求确定购进量



由于每天的需求是随机的，故每天的收入是随机的，优化问题的目标函数应是长期的日平均收入等于每天收入的期望



#### 准备

调查需求量的==随机规律==——每天需求量为 r 的概率 f(r)



#### 建模

设每天购进 n 份，日平均收入为 G(n)

已知售出一份赚 a-b ；退回一份赔 b-c

当 r <= n ，售出 r ，赚 (a-b)r ；退回 (n-r) ，赔 (b-c)(n-r)

当 r > n ，售出 n ，赚 (a-b)n



所以， $G(n)=\sum\limits_{r=0}^n[(a-b)r-(b-c)(n-r)]f(r)+\sum\limits_{r=n+1}^{\infty}(a-b)nf(r)$

求 n 使 $G(n)$ 最大



#### 求解

将 r 视为连续变量，故 $f(r)\implies p (r)dr$ 

原式变为 $G(n)=\int_0^n[(a-b)r-(b-c)(n-r)]p(r)dr+\int_n^{\infty}(a-b)np(r)dr$

将 n 也视为连续变量，故可直接求导

$\frac{dG}{dn}=(a-b)np(n)-\int_0^n(b-c)p(r)dr-(a-b)np(n)+\int_n^{\infty}(a-b)p(r)dr\\=-(b-c)\int_0^np(r)dr+(a-b)\int_n^{\infty}p(r)dr$

令上式为 0 ，可得 $\frac{\int_0^np(r)dr}{\int_n^{\infty}p(r)dr}=\frac{a-b}{b-c}$



根据上式的图像及几何意义，需要求 n 使 P1($\int_0^np(r)dr$) 与 P2($\int_n^{\infty}p(r)dr$) 之比为 $\frac{a-b}{b-c}$

故当 (a-b) 增大时， n 增大；若 (b-c) 增大时， n 减小



#### 航空公司的预订票策略

#### 问题

预订票业务——航公公司为争取客源开展优质服务

1. 预先订票的乘客如果未能按时登机，可以乘坐下一班机或退票，无需附加任何费用
2. 若公司限制预订票的数量等于飞机容量，由于会有订了机票的乘客不按时来，致使飞机不满员而利润降低
3. 如果不限制预订票数量，若持票按时来的乘客超过飞机容量，必然引起不能搭乘乘客的抱怨，给公司带来损失
4. 公司需要综合考虑经济利益和社会声誉，确定预订票数量的最佳限额



#### 问题分析

公司的经济利益可以用机票收入扣除飞行费用和赔偿金后的利润来衡量

社会声誉可以用持票按时前来登机，但因满员不能飞走的乘客（被挤掉者）限制在一定数量为标准



随机因素——预订票的乘客是否按时前来登机

经济利益和社会声誉两个指标都应该在平均意义下衡量

两目标的优化问题，决策变量是预订票数量的限额



#### 模型假设

1. 飞机容量 n ，飞行费用 r （与乘客数量无关），机票价格 $g=r/\lambda n$ ，其中 $\lambda$ 就是==利润调节因子==

   比如 $\lambda$ 为 0.6 ，说明飞机达到 60% 满员率就不亏本

2. 预订票数量的限额 m ，每位乘客不按时前来登机的概率 p ，各位乘客是否按时前来相互独立

3. 每位被挤掉者获得的赔偿金为常数 b



#### 模型建立

每次航班的利润 s = 机票收入 - 飞行费用 - 赔偿金

若 m 位预订票乘客中有 k 位不按时前来

$s=\begin{cases}(m-k)g-r,&m-k\leq n(按时前来者不超过容量)\\ng-r-(m-k-n)b,&m-k>n(按时前来者超过容量)  \end{cases}$  

k 位乘客不按时前来的概率呈二项分布

$p_k=c_m^kp^kq^{m-k},k=0,1,...,m,q=1-p$

故平均利润为 $S(m)=\sum\limits_{k=0}^{m-n-1}[(ng-r)-(m-k-n)b]p_k+\sum\limits_{k=m-n}^m[(m-k)g-r]p_k\\=qmg-r-(g+b)\sum\limits_{k=0}^{m-n-1}(m-k-n)p_k$



公司为维护社会声誉，要求被挤掉者不要太多，用被挤掉者超过若干人的概率作为==度量目标==

被挤掉者超过 j 人（m 人中不按时前来的不超过 m-n-j-1 人）的概率，即  $P_j(m)=\sum\limits_{k=0}^{m-n-j-1}p_k$

对于给定 n ， j ，若 m = n + j ，被挤掉者始终不会超过 j ，此时 $P_j(m)=0$

若 m > n + j ，$P_j(m)$ 将随 m 增加而单调增加



优化问题目标函数，以 $P_j(m)$ 不超过某个给定值为约束条件，以平均利润 $S(m)$ 为单目标函数



#### 模型求解

$J(m)=\frac{S(m)}{r}=\frac{1}{\lambda n}[qm-(1+b/g)\sum\limits_{k=0}^{m-n-1}(m-k-n)p_k]-1$

约束条件 $P_j(m)=\sum\limits_{k=0}^{m-n-j-1}p_k\leq \alpha$

$\alpha$ 为给定值，对于给定的 n ，$\lambda,p,b/g$ 求 m 使 J(m) 最大



#### 模型改进

将乘客分为两类，第一类实施上述预订票业务，第二类降低票价，购票时幅宽，不按时前来登机则机票作废

设 m 张预订票中有 t 张是预售给第二类乘客的，其折扣票价位 $\beta g$ ，平均利润为

$S(m)=\sum\limits_{k=0}^{m-n-1}[t\beta g+(n-t)g-r-(m-k-n)b]p_k+\sum\limits_{k-m-n}^{m-t}[t\beta g+(m-t-k)g-r]p_k$



###学术作弊现象的调查和估计

#### 背景

统计调查中会遇到因涉及个人隐私或厉害关系而不受对象欢迎或感到尴尬的所谓敏感问题

即使采用无记名调查也很难消除被调查者的顾虑，极有可能拒绝或故意做出错误的回答，难以保证数据的真实性，使调查结果存在很大的误差

以对学生考试作弊现象的调查和估计为例，建立数学模型研究敏感问题的调查和估计方法



#### 问题及分析

设计合理的==调查方案==来提高应答率，降低不真实回答率，尽量准确地==估计==有过==作弊==行为学生所占bii

基本思路：

让被调查者从包含是否做过弊的若干问题中，随机地选答其中一个，让调查者也不知道被调查者回答的是哪个问题，以便消除调查者的顾虑，对自己所选的问题真实作答



#### Warner 模型（正反问题选答）

方案设计：设计两个相反的问题供学生们选答其中一个：

问题 A ：你在考试中做过弊吗？

问题 B ：你在考试中没有做过弊吗？

选答规则：

准备一套 13 张同一花色的扑克（如红心）

被调查的学生随机抽取一张，看后还原

学生抽取的是不超过 10 的数（A 看作 1），则回答问题 A

学生抽取的是 J Q K ，则回答问题 B



##### 模型假设

1. 共 n 位被调查学生均独立作答
2. 被调查学生一旦选定应回答的问题，他将真实作答
3. 选答 A 题的学生比例为 p
4. 对问题 A B 两题选答 "是" 的学生共 n1 位，选答 "是" 的比例 $\pi$ 的估计值为 $\hat{\pi}=n_1/n$



##### 目的

估计有过作弊行为学生的比例 $\pi_A$ 对问题 A 回答 "是" 的比例



$X_i=\begin{cases}1,&若第 i 个被调查学生回答 是 \\0，&若第 i 个被调查学生回答 否  \end{cases}$

$X_1,X_2,...,X_n$ 独立同分布

故 $E(X_i)=\pi,D(X_i)=\pi(1-\pi)$

全概率公式为 $\pi=P(X_i=1)=p\pi+(1-p)(1-\pi_A)$

用 $\hat{\pi}$ 近似替换 $\pi$ ，故 $\pi_A$ 的估计值为 $\hat{\pi}_A=\frac{\hat{\pi}-(1-p)}{2p-1}$



对 $\hat{\pi}_A$ 的性质及分析

无偏性：$E(\hat{\pi}_A)=\frac{1}{2p-1}E[\frac{1}{n}\sum\limits_{i=1}^nX_i-(1-p)]=\pi_A$

方差： $D(\hat{\pi}_A)=\frac{\pi(1-\pi)}{(2p-1)^2n}$

方差分解：$D(\hat{\pi}_A)=\frac{\pi_A(1-\pi_A)}{n}+\frac{p(1-p)}{(2p-1)^2n}$

前一项为直接调查并真实回答下的方差，后一项为随机回答机制带来的方差



## 统计回归模型

#### 牙膏的销售量

#### 问题

建立牙膏销售量与价格、广告投入之间的模型；预测在不同价格和广告费用下的牙膏销售量

收集了 30 个销售周期本公司牙膏销售量、价格、广告费用，及同期其他厂家同类牙膏的平均售价



#### 基本模型

设 y 为公司牙膏销售量

 x1 为其他厂家与本公司的价格差

 x2 为公司广告费用



如令 $y=\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_2^2+\epsilon$

y 为解释变量（因变量）

$x_1,x_2$ 为解释变量（回归变量，自变量）

$\epsilon$ 为随机误差（均值为零的正态分布随机变量）



在 MATLAB 中通过 [b, bint, r, rint, status] = regress(y, x, alpha) 进行操作

输入 ： y 为n维数据向量； x = [1, x1, x2, x^2] 为 n*4 数据矩阵，第一列为全 1 向量

alpha 为置信水平，0.05



输出： b 为各个 $\beta$ 的估计值； bint 为 b 的置信区间； r 为残差向量 y-xb； rint 为 r 的置信区间

status 为检验统计量，R^2 能够说明得出的式子能有表示真实结果的百分率；F 是当 n 和 r 确定时，F 值越大， 越可靠；p 是越小越好，是反应置信水平下的满足程度；s^2 反应的是误差平方和



#### 模型改进

上述模型只考虑 $x_1$ 和 $x_2$ 对 y 的影响对立； 改进为 $x_1$ 和 $x_2$ 对 y 的影响有交互作用



### 软件开发人员的薪金

剪力模型研究薪金与资历、管理责任、教育程度的关系，分析人事策略的合理性，作为新聘用人员薪金的参考



#### 分析与假设

x1 表示资历； x2-1 表示管理人员； x2-0 表示非管理人员

由于教育有三个等级， 1 表示中学， 2 表示大学， 3 表示更高

可以通过两个 01 变量进行表示

$x_3=\begin{cases}1,&中学\\0,&其他  \end{cases}$

$x_4=\begin{cases}1,&大学\\0,&其他  \end{cases}$

假设资历每加一年薪金的增长是常数，且管理、教育、资历之间无交互作用

建立模型：$y=a_0+a_1x_1+a_2x_2+a_3x_3+a_4x_4$

如此求出的置信区间包含 0 点，故不可靠，需要改进



进一步模型，增加管理 $x_2$ 与教育 $x_3,x_4$ 的交互项

$y=a_0+a_1x_1+a_2x_2+a_3x_3+a_4x_4+a_5x_2x_3+a_6x_2x_4+\epsilon$

此时 $R^2$ 和 F 有改进，所有回归系数置信区间不含零点，模型完全可用



### 投资额与国民生产总值和物价指数

#### 问题

建立投资额模型，研究某地区实际投资额与国民生产总值（GNP）及物价指数（PI）的关系

根据对未来GNP 及 PI 的估计，预测未来投资额



#### 分析

许多经济数据在时间上有一定的滞后性

以时间为序的数据，称为时间序列

时间序列中同一变量的顺序观测值之间存在自相关

若采用普通回归模型直接处理，会出现不良后果

需要诊断并消除数据的自相关性，建立新的模型



#### 基本回归模型

设 t 为年份； yt 为投资额； x1t 为GNP； x2t 为物价指数

首先先尝试性建立三者的关系

可得 $y_t=\beta_0+\beta_1x_{1t}+\beta_2x_{2t}+\epsilon_t$

说明投资额与 GNP 及物价指数间有很强的线性关系

##### 结果与分析

模型优点： $R^2$ 大，拟合度高

模型缺点：没有考虑时间序列数据的滞后性影响，可能忽视了随机误差存在自相关；如果存在自相关性，用此模型会有不良后果



##### 自相关性的定性诊断

采用残差诊断法

模型残差为 $e_t=y_t-\hat{y}_t$

通过 MATLAB 作残差的 ei 和 ei-1 散点图

大部分点落在第1， 3 象限，说明随机误差存在正的自相关

大部分点落在第 2， 4 象限，说明随机误差存在负的自相关



#### 自回归性的定量诊断 D-W 检验

将随机误差用 $\epsilon_t=\rho\epsilon_{t-1}+u_t$ 表示

其中 $\rho$ 为自相关系数， $|\rho| <1$

ut 表示对 t 相互独立的零均值正态随机变量

$\rho=0$ 表示无相关性； $\rho>0$ 表示存在正相关性； $\rho<0$ 表示存在负自相关性

如何估计 $\rho$ 需要使用 D-W 统计量

如何消除自相关性，需要使用广义差分法



D-W 统计量当 n 足够大时， DW = 2(1-$\hat{\rho}$) 表示

其中 $\hat{\rho}=\sum\limits_{t=2}^ne_te_{t-1}/\sum\limits_{t=2}^ne_t^2$

由于 $-1\leq \hat{\rho}\leq1$ ，所以 $0\leq DW \leq 4$

根据检验水平，样本容量，回归变量数目等确定 DW 值，从而确定自相关性



#### 广义差分变换

由于原模型中使用存在 $\epsilon$ 数值

通过 $y_t^*=y_t-\rho y_{t-1}$  进行变换，这样可以消除 $\epsilon$

$x_{it}^*=x_{it}-\rhox_{i,t-1}$

故，新模型是 $y_t^*=\beta_0^*+\beta_1x_{it}^*+\beta_2x_{2t}^*+u_t$ ， $\beta_)^*=\beta_0(1-\rho)$

以上述系数为回归系数作普通回归模型



## 博弈模型

由于需要考虑多个主体，并且决策主体的决策行为发生直接相互作用时需要采用博弈模型

可分为合作博弈和非合作博弈

也可以分为静态、动态；信息完全和不完全



### 进攻与撤退的抉择

#### 模型假设

博弈参与者为双方（盟军和德军）

盟军有 3 种使用其预备队的行动：强化缺口，原地待命，东进；德军有 2 种行动：向西进攻或向东撤退

博弈双方完全理性，目的都是使战斗中乙方获得的净胜场次（胜利场次减去失败场次）尽可能多

|          |  向西进攻   |  向东撤退   |
| :------: | :---------: | :---------: |
| 强化缺口 | 盟军胜 1 场 |   无战斗    |
| 原地待命 | 盟军胜 2 场 |   无战斗    |
|   东进   | 盟军败 2 场 | 盟军胜 1 场 |

且双方同时做出决策

共同知识（以上信息双方共有）



#### 博弈模型

博弈参与者集合 N = {1, 2}(1 为盟军， 2 为德军)

盟军行动 $a_1\in A_1={1, 2, 3}$ （强化缺口/原地待命/东进）

德军行动 $a_2\in A_2={1,2}$ （进攻/撤退）

用 $u_1(a_1,a_2)$ 表示对盟军产生的结果，即净胜场次，称为盟军的效用函数

上述表格可用矩阵代替

$M={m_{ij}}=\begin{bmatrix} 1&0\\2&0\\-1&1 \end{bmatrix}$

由于完全竞争，故 $u_2(a_1,a_2)=-M$



#### 纳什均衡

NE：单向改变战略不能提高自己效用，即每一方的战略对于他方 的战略而言都是最优的，称为最优反应

$u_1(a_1^*,a_2^*)\geq u_1(a_1,a_2^*)$

$u_2(a_1^*,a_2^*)\geq u_2(a_1,a_2)$

但根据上述矩阵考虑，不存在 NE



#### 混合战略

盟军的混合战略集

$S_1=\{p=(p_1,p_2,p_3)|0\leq p_i\leq1,\sum\limits_{i=1}^3=1\}$

德军的混合战略集

$S_2=\{q=(q_1,q_2)=0\leq q_i\leq1,\sum\limits_{i=1}^2q_i=1\}$

期望收益为 $U_1(p,q)=pMq=\sum\limits_{i=1}^3\sum\limits_{j=1}^2p_im_{ij}q_j$

$U_2(p,q)=-U_1(p,q)$

对于盟军，需要取 $\max\limits_{p \in S_1}pMq^T$

对于德军，需要取 $\min\limits_{q\in S_2}pMq^T$



#### 模型求解

理性推理：不管自己怎么做，另一方总是希望尽量使自己得分尽量低（二人零和博弈）

从一个给定的战略中期望得到的收益，总是采用该策略时他们可能得到的最坏的收益

盟军可以通过 minpM 来衡量策略 p 的好坏

德军可以用 maxM$q^T$ 来衡量策略 q 的好坏

盟军需要在 minpM 的条件下，选择 p 使 U1 最大

德军需要在 maxM$q^T$ 的条件下，选择 q 使 U2 最小



### 一口价 的战略

讨价还价很浪费买卖双方的宝贵时间

#### 背景

为了节省讨价还价的时间，考虑一口价模式

双方同时报价：若卖价 >= 卖价，则以均价成交；否则不成交

问题：双方应如何报价？双方总能成交吗？（效率估计）



#### 模型假设与建立

卖方知道物品对自己的价值，但买方不知道

买房知道物品对自己的价值，但卖方不知道

双方都知道（猜出）对方价值的分布信息

卖方价值 $v_s$ ，买房价值 $v_b$ ，均服从U[0， 1] (均匀分布)

卖方报价 $p_s$ ，买方报价 $p_b$ ，若 $p_b\geq p_s$ 时成交价为 $p=(p_b+p_s)/2$

成交效用： 卖方$U_1=p-v_s $ ，买方 $U_2=v_b-p$ ；不成交：0

双方完全理性（最大化自己的期望效用）且以上知识是共同知识



信息非对称（不完全信息）

不完全信息静态博弈（静态贝叶斯博弈）

双方战略

卖方报价 $p_s=p_s(v_s)$

买方报价 $p_b=p_b(v_b)$

上述情况应定义在 [0, 1] 区间上，取值也在 [0, 1] 区间上的非减函数



考虑纳什均衡，故单向改变战略不能提高自己效用

均衡条件

卖方： $\max\limits_{p_s}[\frac{p_s+E[p_b(v_b)|p_b(v_b)\geq p_s]}{2}-v_s]*Pr\{p_b(v_b)\geq p_s\}$

买方：$\max\limits_{p_b}[v_b-\frac{p_b+E[p_s(v_s)|p_b(v_b)\leq p_s]}{2}]*Pr\{p_b\geq p_s(v_s)\}$

具体战略形式不同，均衡就可能不同



单一价格战略

$p_s(v_s)=\begin{cases} x,&v_s\leq x\\1,&v_s>x \end{cases}$

$p_b(v_b)=\begin{cases}x,&v_b\geq x\\0,&v_b<x \end{cases}$

双方战略互为最优反应，所以构成贝叶斯纳什均衡

对给定的 $(v_s,v_b)$ ，当 $v_s<v_b$ 时，称为交易是有利的；交易给双方带来的效用之和，即 $v_b-v_s$ 称为交易价值

对于给定战略组合，能够实际发生的交易的期望价值与有利的全部交易的期望价值的比值称为该战略的交易效率

故单一价格战略效率为

$\eta=\frac{\int_x^1\int_0^x(v_b-v_s)dv_sdv_b}{\int_0^1\int_0^{v_b}(v_b-v_s)dv_sdv_b}=3x(1-x)\leq3/4$



#### 线性价格战略

效率最大且不存在使所有有利的交易都成立的均衡战略组合



### 不患寡而患不均

#### 模型假设与建立

接受建议：甲乙所得 $x_1=1-s,x_2=s$ ；否则 $x_1=x_2=0$

1. 每个人参与者都喜欢对所有参与者公平的结果
2. 每个参与者自己受到不公平对待时的愤怒，胜过其他参与者受到不公平对待时的愧疚



效用函数 $U_1(x_1,x_2)=x_i-\alpha _i \max(x_j-x_i,0)\beta_i \max(x_i-x_j,0)$

其中 $i=1,2,j=3-i$ ,$\alpha_i\geq\beta_i\geq0$

一般认为 $\beta_i<1/2$ 否则当 $x_i>x_j=1-x_i$ 时， $U_i(x)=x_i\beta_i(x_i-x_j)=\beta_i-(2\beta_i-1)x_i$

此时，关于 $x_i$ 的系数非正，即表示为过分愧疚



#### 模型求解

对于乙的最优反应（给定 s）

如果不接受，则 $x_1=x_2=0$ ， $U_1(s)=U_2(s)=0$

如果不接受，则 $x_1=1-s$  , $x_2=s$

若 $s\geq1/2$ ，则 $x_2\geq x_1$ ， $U_2(s)=s-\beta_2(2s-1)\geq1/2\geq0$

若 $s\leq1/2$ ，则 $x_2\leq x_1$ ， $U_2(s)=s-\alpha_2(1-2s)=(1+2a_2)s-\alpha_2$

若 $U_2(s)\geq0$ ，所以 $s\geq\overline{s}(\alpha_2)=\alpha_2/(1+2\alpha_2)$ ，易知 $0\leq\overline{s}(\alpha_2)<1/2$

当 s = 1/2 ，两者一致

故乙的最优反应为  $s\geq\overline{s}(\alpha_2)$ 时接受，否则不接受



甲的决策（只考虑乙接受情形）

case 1 ：甲知道乙的 $\alpha_2$

若 $s\geq1/2$ ，则 $x_2\geq x_1$ , $U_1(s)=1-s-\alpha_1(2s-1)$ ，当 s=1/2 时达到最大值 1/2

若 $s\leq1/2$ ，则 $x_2\leq x_1$ ，$U_1(s)=1-s-\beta_1(1-2s)=1-\beta_1+(2\beta_1-1)s$ 

但 $s\geq \overline{s}(\alpha_2)$ ，故甲的决策应为 $s^*=\overline{s}(\alpha_2)=\alpha_2/(1+2\alpha_2)$



case 2 : 甲不知道乙的 $\alpha_2$ 但知道 $\alpha_2$ 的分布 $F(\alpha_2)$

$\underline{a}=\max\{\alpha|F(\alpha)=0 \}$

$\overline{a}=\min\{\alpha|F(\alpha)=1 \}$

若 $s\geq1/2$ ，则 $x_2\geq x_1$ , $U_1(s)=1-s-\alpha_1(2s-1)$ ，当 s=1/2 时达到最大值 1/2

若 $s\leq1/2$ ，则 $x_2\leq x_1$ ,

此时乙接受的概率为

$\rho=\begin{cases}0,&s\leq \overline{s}(\underline{\alpha})\\F(s/(1-2s)),&\overline{s}(\underline{\alpha})<s<\overline{s}(\overline{\alpha})\\1,&s\geq\overline{s}(\overline{\alpha})  \end{cases}$

故可得各个条件下的期望效用

但甲最佳的决策应为 $\max\limits_{\overline{s}(\underline{\alpha})<s<\overline{s}(\overline{\alpha})}[1-\beta_1+(2\beta_1-1)sF(s/(1-2s))]$



#### 模型解释

甲永远不会提出大于1/2的方案s

乙拒绝过小的方案 s

乙接受概率随 s 增加而不减



### 效益的合理分配

甲乙丙三人合作经商，若加以合作获利 7 元，甲丙合作获利 5 元，乙丙合作获利 4 元，三人合作获利 11 元，又知每人单干获利 1 元，问三人合作时如何分配获利？

记甲乙丙三人分配为 $x=(x_1,x_2,x_3)$

故 $x_1+x_2+x_3=11$ ， $x_1+x_2\geq7$ , $x_1+x_3\geq5$ ，$x_2+x_3\geq4$ ， $x_1,x_2,x_3\geq1$

可知上述方程组解不唯一，如 (5, 3, 3) (4, 4, 3)



#### Shapley 合作对策

集合 $I=\{1,2,...,n \}$ 中，对 $\forall$ 子集 $s\in I$ ，$\exists$ 实函数 v(s) 满足

$v(\phi)=0$ 且 $v(s_1\bigcup s_2)\geq v(s_1)+v(s_2)$ ，其中 $s_1\bigcap s_2=\phi$

[I, v] 表示 n 人合作对策， v 为特征函数， v(s) 表示子集 s 的获利

$x=(x_1,x_2,...,x_n)$ 表示 n 人从 v(I) 中获得的分配，满足

$\sum\limits_{i=1}^nx_i=v(I)$ 且 $x_i\geq v(i)$



##### 公理化方法

$x_i=\sum\limits_{i\in S_I}w(|s|)[v(s)-v(s/i)] $，其中 $w(|s|)=\frac{(n-|s|)!(|s|-1)!}{n!}$

其中， |s| 表示子集 s 中的元素数目， $S_i$ 表示包含 i 的所有子集

[v(s)-v(s\i)] 表示 i 对合作 s 的贡献

w(|s|) 表示由 |s| 决定的贡献的权重



如对于本例，甲的分配 $x_1$ 的计算

|          s1           |  1   | 1和2 | 1和3 |  I   |
| :-------------------: | :--: | :--: | :--: | :--: |
|         v(s)          |  1   |  7   |  5   |  11  |
|        v(s\i)         |  0   |  1   |  1   |  4   |
|      v(s)-v(s\i)      |  1   |  6   |  4   |  7   |
|         \|s\|         |  1   |  2   |  2   |  3   |
|       w(\|s\|)        | 1/3  | 1/6  | 1/6  | 1/3  |
| w(\|s\|)[v(s)-v(s\i)] | 1/3  |  1   | 2/3  | 7/3  |

故可得 $x_1=13/3$ ，同理可知 $x_2=23/6$ ,$x_3=17/6$



##### Shapley 合作对策小结

优点：公正、合理，有公理化基础

缺点：需要知道所有合作的获利，即要定义 I={1,2,...,n} 的所有子集（共2^n-1）个特征函数，实际上常做不到



### 加权投票中权力的度量

#### 背景

股份制公司每位股东投票和表决权的大小是由所占有的股份多少决定

代表投票的权重取决于所代表区域的人口数量



典型案例：美国总统选举实行的选举人制度

美全国 50 个州和华盛顿特区共 538 张选举人票

获选举人票数一半以上的总统候选人当选总统

各州选举人票数与该州在国会的参议员、众议员数相等

参议员每州两位，众议员人数由各州人口比例确定

人口悬殊巨大使各州选举人票数相差很大



但全美 48 个州和华盛顿特区都实行胜者全得的规则

总统候选人在各州内进行普选，获得相对多数选票的候选人得到该州的全部选举人票

若有几个人口多的州如此，正在选举人投票中就可能使各州累计得票最多的候选人反而不能获胜

选举结果违反全国多数人的意愿



由若干区域组成的机构中，每区代表的数量按照人口比例分配，进行投票选举和表决时，每区的全体代表投相同的票

或者说是每区各派宜为代表，按照他们所代表的各区人口比例赋予投票的权重



#### 问题

加权投票中权力的度量

如何度量每位代表的投票对最终结果的影响力

1.  介绍两种合理的、度量权力的数量指标
2. 通过实例给出它们的应用
3. 调整投票人的权重使其权力大致与代表的人口成比例



#### 加权投票与获胜联盟

例：一县 5 区（A,B,C,D,E） 人口为 60,20,10,5,5（千人），每区一位代表按人口比例分配其投票权重为12,4,2,1,1

按照简单多属规则（权重之和超过总权重的一半）决定投票结果

此时 A 区代表为独裁者（能决定投票结果），其他代表都是傀儡

##### 改革

将 A 区分成人口相等的 3 个子区 A1， A2， A3

此时代表的投票权重为 4,4,4,4,2,1,1

决定投票结果的区域集合是 [A1, A2, A3],[A1, A2, B] , [A1, A3, C, D] , [A1, B, C, E] , [A1, A3, B, D] ...



##### 加权投票系统

$S=[q:w_1,w_2,...,w_n]$

投票人集合 $N=\{A,B,C,...\}$ 共 n 人，权重分别为 $w_1,w_2,...w_n$

定额 q 表示投赞成票的投票人权重之和 >= q 时决议通过

$w=w_1+w_2+...+w_n$ ，一般设 $w/2< q \leq w$ 

对简单多数规则且权重取整数，q 为大于 w/2 的最小整数

获胜联盟为权重之和 >= 定额 q 的投票人子集

极小获胜联盟表示如果没有它的一个真子集也是获胜联盟

令获胜联盟为 $W$ ，极小获胜联盟集为 $W_m$



例 2 ：某系一委员会由主任 A 、教授 B 、学生 C 组成，

投票权重为 $w_1,w_2,w_3$ ，集中加权投票系统

$S^{(1)}=[3:3, 1, 1]$ ，$W_m=([A])$表示 A 为独裁者， B, C 是傀儡

$S^{(2)}=[2:1, 1, 1]$ ，$W_m=([AB], [AC], [BC])$ 表示 A B C 权力相同

$S^{(3)}=[4:2, 2, 1]$ ，$W_m=([AB])$ 表示 AB 权力相同， C是傀儡

$S^{(4)}=[3:2, 1, 1]$ ，$W_m=([AB], [AC])$ 表示 BC 权力相同， A 有否决权

所以给定系统能得到获胜联盟和极小获胜联盟

但给定获胜联盟或极小获胜联盟却不一定得到加权投票系统



##### 权力指标

度量投票人权力的数量指标应具有的性质：

1. 每人投票人 i 有一个非负实数 ki 作为他的权力指标
2. 当且仅当 i 不属于任何一个极小获胜联盟时， ki 为 0
3. 当权重 $w_i >w_j$ 时，则 $k_i>k_j$
4. 当投票人 i 和 j 在 W 中对称时，ki=kj
5. 归一化 $\sum\limits_{i \in N}k_i=1$ （不是必须）



满足这些性质的数量指标不是唯一



比如按照 $S^{(4)}=[3:2, 1, 1]$ 的加权投票系统， 3 位投票人的全排列为 ABC , ACB, BAC, BCA , CAB , CBA

对于 ABC : 当 A 增至 AB 时 变为获胜联盟，故 B 为决定因素

对于 ACB : 当 A 增至 AC 时变为获胜联盟，故 C 为决定因素

对于 BCA : 当 BC 增至 BCA 时变为获胜联盟，故 A 为决定因素

...

这样就可以得到 Shapley 指标为 (4, 1 ,1) ，归一化后为 (4/6, 1/6, 1/6)

由于 B 和 C 对称，也可直接得出两者的权力指标应该相同



步骤如下：

1. 写出投票人的共 n！个全排列
2. 对每一个排列由左向右依次检查，若某位投票人加入时该集合变成获胜联盟，称该投票人为决定者
3. 将每位投票人在所有排列中成为决定者的次数除以 n！ 定义为它们的 Shapley 权力指标



##### Banzhaf 权力指标

$S^{(4)}=[3:2, 1, 1]$ 的获胜联盟有 $W=([AB], [AC],[ABC])$

对于[AB] ，由于 A 和 B 的加入才成为获胜联盟，故 AB 重要

对于 [AC] ，由于 A 和 C 的加入才成为获胜联盟，故 AC 重要

对于 [ABC] ，由于 A 的加入才成为获胜联盟，故 A 重要

故此时权力指标为 (3, 1, 1) ，归一化处理得 (3/5, 1/5, 1/5)



主要步骤为：

1. 写出投票人的获胜联盟 W
2. 对每一个获胜联盟检查每位投票人是否为决定者
3. 将每位投票人在所有获胜联盟中成为决定者的次数归一化，得到 Banzhaf 权力指标



例 3 ：拳击比赛设 2 个 5 人裁判组，每人一票，若第 1 组以5：0 或 4： 1 判选手甲胜利，则甲胜；若以 3 ： 2 判甲胜，则第 2 组再判；除非第 2 组以 0:5 或1:4 判甲负，其他情况最终都判甲胜

将上述裁判规则用加权投票系统表示

计算系统的 Shapley 指标和 Banzhaf 指标

设两组 10 人同时裁判，组成 N = {A,A,A,A,A,B,B,B,B,B}

S = {q:a,a,a,a,a,1,1,1,1,1}

此时，极小获胜联盟为 [4A], [3A2B], [2A4B]

故 4a >= q , 3a+2 >= q, 2a+4 >= q

可以取多组值，如 a=2， q=8 ，并按简单少数原则进行



## 马氏链模型

描述一类重要的随机动态系统（过程）的模型

系统在每个时期所处的状态是随机的

从一个时期到下时期的状态按一定概率转移

下时期状态只取决于本时期状态和转移概率

已知现在，将来与过去无关（无后效性）



Markov Chain——时间、状态均为离散的随机转移过程



### 健康与疾病

通过有实际背景的例子介绍马氏链模型的基本概念和性质

人的健康状态随着时间的推移会随机地发生改变

保险公司要对投保人未来的健康状态作出估计，以制定保险金和理赔金的数额



例 1 ：人的健康状况分为健康和疾病两种状态，设对特定年龄段的人，今年健康、明年保持健康状态的概率为 0.8 ，而今年患病、明年转为健康状态的为 0.7

若某人投保时健康，问 10 年后他仍处于健康状态的概率



#### 状态与状态转移

状态 $X_n=\begin{cases}1,&第n年健康\\2,&第n年疾病 \end{cases}$

状态概率 $a_i(n)=P(X_n=i),i=1,2,n=0,1,...$

转移概率 $p_{ij}=(X_{n+1}=j|X_n=i),i,j=1,2;n=0,1,...$

p11 = 0.8 ; p12 = 1 - p11 = 0.2 ; p21 = 0.7 ; p22 = 1 - p21 = 0.3

$X_{n+1}$ 只取决于 $X_n$ 和 $p_{ij}$ ，与 $X_{n-1} ，...$ 无关

状态转移具有无后效性，即：

$a_1(n+1)=a_1(n)p_{11}+a_2(n)p_{21}$

$a_2(n+1)=a_1(n)p_{12}+a_2(n)p_{22}$



故按上式计算，可知，当 n 达到一定大小时，a1 为 7/9 ， a2 为 2/9



#### 马氏链的基本方程

状态 $X_n=1,2,...,k(n=0,1,...)$ 

状态概率 $a_i(n)=P(X_n=i),i=1,2,...,k;n=0,1,...$

$\sum\limits_{i=1}^ka_i(n)=1$

转移概率 $p_{ij}=P(X_{n+1}=j|X_n=i),p_{Ij}\geq0,\sum\limits_{j=1}^kp_{ij}=1,i=1,2,...,k$

基本方程 $a_i(n+1)=\sum\limits_{j=1}^ka_j(n)p_{ij},i=1,2,...,k$

$a(n)=(a_1(n),a_2(n),...,a_k(n))$ 称为状态概率向量

$P=\{p_{ij} \}$ 为转移概率矩阵，矩阵非负，且行和为 1

$a(n+1)=a(n)P$

且 $a(n)=a(0)P^n$



#### 马氏链的两个重要类型

1. 正则链：从任一状态出发经有限次转移能以正概率到达另外任一状态

正则链 $\iff \exists N,P^N>0$

正则链 $\implies \exists w,a(n) \to w(b\to \infty)$

故 $wP=w$

对于例 1 ，$P=\begin{bmatrix}0.8&0.2\\0.7&0.3 \end{bmatrix}$

故 0.8w1 + 0.7w2 = w1 ; 0.2w1 + 0.3w2 = w2 ；且 w1 + w2 = 1

故 w1 = 7/9 ； w2 = 2/9



2. 吸收链：存在吸收状态（一旦到达就不会离开的状态 i ，pij = 1），且从任一非吸收状态出发经有限次转移能以正概率到达吸收状态

有 r 个吸收状态的吸收链的转移概率针标准形式

$P=\begin{bmatrix}I_{r\times r}&0\\R&Q \end{bmatrix}$

此时 R 中必定有非零元素

$M=(I-Q)^{-1}=\sum\limits_{r=0}^{\infty}Q^s$

$y=(y_1,y_2,...y_{k-r})=Me$

e = (1, 1, 1... 1)

yi 表示从第 i 个非吸收状态出发，被某个吸收状态吸收前的平均转移次数



### 钢琴销售的存储策略

#### 背景与问题

钢琴销售量很小，商店的库存量不大以免积压资金，一家商店根据经验估计，平均每周的钢琴需要为 1 架

存贮策略：每周末检查库存量，仅当库存量为零时，才订购 3 架供下周销售；否则，不订购

估计在这种策略下失去销售机会的可能性有多大？以及每周的平均销售量是多少？



#### 问题分析

顾客的到来相互独立，需求量近似服从泊松分布，其参数由需求均值为每周 1 架 确定，由此计算需求概率

存贮策略是周末库存量为零时订购 3 架——周末的库存量可能是 0，1,2,3；周初的库存量可能是 1,2,3

用马氏链描述不同需求导致的周初库存状态的变化

动态过程中每周销售量不同失去销售机会（需求超过库存）的概率不同

可按稳态情况（时间充分长以后）计算失去销售机会的概率和每周的平均销售量



设 $D_n$ 为第 n 周的需求量，满足均值为 1 的泊松分布

$p(D_n=k)=e^{-1}/k!(k=0,1,2,...)$

| Dn   | 0     | 1     | 2     | 3     | >3    |
| ---- | ----- | ----- | ----- | ----- | ----- |
| P    | 0.368 | 0.368 | 0.184 | 0.061 | 0.019 |

设 $S_{n}$ 为第 n 周的初的库存量

得到状态转移规律

$S_{n+1}=\begin{cases}S_n-D_n,&D_n<S_n\\3,&D_n\geq S_n \end{cases}$

故状态转移矩阵为

$P=\begin{bmatrix}p_{11}&p_{12}&p_{13}\\ p_{21}&p_{22}&p_{23}\\p_{31}&p_{32}&p_{33} \end{bmatrix}$

$p_{11}=P(S_{n+1}=1|S_n=1)=P(D_n=0)=0.368$

$p_{12}=P(S_{n+1}=2|S_n=1)=0$

...

故转移矩阵为

$P=\begin{bmatrix}0.368&0&0.632\\ 0.368&0.368&0.264\\0.184&0.368&0.448 \end{bmatrix}$



根据 $a(n+1)=a(n)P$ ，可知当初始状态已知时，可预测第 n 周初库存量 $S_n=i$ 的概率

由于 正则链 $\iff \exists N,P^N>0$ ,本题中 $P^2>0$ ，故为正则链

所以，稳态概率分布 w 满足 $wP=w$

可得 $w=(w_1,w_2,w_3)=(0.285,0.263,0.452)$

所以当 $n\to \infty$ 时，状态概率 $a(n)=(0.285,0.263,0.452)$



#### 模型求解

存贮策略的评价指标：估计失去销售机会的可能性

第 n 周失去销售机会的概率

$P(D_n>S_n)=\sum\limits_{i=1}^3P(D_n>i|S_n=i)P(S_n=i)\\=P(D>1)w_1+P(D>2)w_2+P(D>3)w_3\\=0.264*0.285+0.08*0.263+0.019*0.452=0.105$



#### 存贮策略的评价指标：估计每周的平均销售量

第 n 周平均售量

$R_n=\sum\limits_{i=1}^3\sum\limits_{j=1}^ijP(D_n=j|S_n=i)+iP(D_n>i,S_n=i)$

前一部分为需求不超过存量，需求被售；后者为需求超过存量，存量被售

$=\sum\limits_{i=1}^3[\sum\limits_{j=1}^ijP(D_n=j,S_n=i)+iP(D_n.i,S_n=i)]P(S_n=i)\\=0.632*0.285+0.896*0.263+0.977*0.452=0.857$

故，长期来看，每周的平均销售量为 0.857 架



#### 敏感性分析

当平均需求在每周 1 架附近波动时，最终结果有多大变化

设 $D_n$ 服从均值 $\lambda$ 的泊松均布 $P(D_n=k)=\lambda^ke^{-\lambda}/k!,(k=0,1,2...)$

状态转移阵

$P=\begin{bmatrix}e^{-\lambda}&0&1-e^{-\lambda}\\\lambda e^{-\lambda}&e^{-\lambda}&1-(1+\lambda)e^{-\lambda}\\\lambda^2e^{-\lambda}/2&\lambda e^{-\lambda}&1-(\lambda+\lambda^2/2)e^{-\lambda}  \end{bmatrix}$

第 n 周失去销售机会的概率 $P=P(D_n>S_n)$

当平均需求 $\lambda=1.0$ 增长或减少10%时，失去销售机会的概率 P 将增长或减少 15%



### 等级结构

社会系统中需要适当且稳定的等级结构

1. 描述等级结构的演变过程，预测未来的结构
2. 确定为达到某个理想结构应采取的策略

引起等级结构变化的因素：

1. 系统内部等级间的转移：提升和降级
2. 系统内外的交流：调入和退出



用马氏链模型描述确定型的转移问题



#### 基本模型

等级 i = 1, 2, ... , k

数量分布 $n(t)=(n_1(t),n_2(t),...,n_k(t))$

$n_i(t)$ 表示 t 年属于等级 i 的人数

$N(t)=\sum\limits_{i=1}^kn_i(t)$ 表示 t 年的总人数

比例分布为 $a(t)=(a_1(t),a_2(t),...,a_k(t))$

故 $a_i(t)=\frac{n_i(t)}{N(t)}$

$a(t)$ 表示等级结构， $a_i(t)\geq0$ ， $\sum\limits_{i=1}^ka_i(t)=1$

转移矩阵 $Q=\{p_{ij} \}$ 表示每年从 i 转至 j 的比例



退出比例 $w=(w_1,w_2,...,w_k)$ ， $w_i$ 表示从 i 退出的比例

$W(t)=\sum\limits_{i=1}^kw_in_i(t)$ 表示 t 年退出总人数

$\sum\limits_{j=1}^kp_{ij}+w_i=1$



调入比例为 $r=(r_1,r_2,...r_k)$ ， $r_I>0,\sum\limits_{i=1}^kr_i=1$

$r_i$ 表示每年调入 i 的比例

$R(t)$ 表示 t 年调入总人数，故 $rR(t)$ 表示 t 年调入 i 的人数



总人数 $N(t+1)=N(t)+R(t)-W(t)$

等级 j 人数 $n_j(t+1)=\sum\limits_{i=1}^kp_{ij}n_i(t)+r_jR(t)$

$n(t+1)=n(t)Q+R(t)r$

总人数增量 $M(t)=N(t+1)-N(t)$

$R(t)=W(t)+M(t)=n(t)w^T+M(t)$

代入得 $n(t+1)=n(t)(Q+w^Tr)+M(t)r$



记 $P=Q+w^Tr$ ，故 $n(t+1)=n(t)P+M(t)r$

若假设总人数不变，故 $M(t)=0$

此时前式可转化为 $a(t+1)=a(t)P=a(t)(Q+w^Tr)$

此时可见与马氏链模型基本方程一致



#### 用调入比例进行稳定控制

问：当给定 Q 后，哪些等级结构可以用合适的调入比例保持不变

所以此时，若存在 r 使 $a=a(+w^Tr)$ ，称 $a=(a_1,...a_k)$ 为稳定结构，所以 $r=\frac{a-aQ}{aw^T}$

故可得 $a\geq aQ\implies r\geq0$ ，此时 a 为稳定结构



## 动态优化模型

优化目标是数值；最优策略是函数

函数对应 的数值称为泛函（函数的函数）

联系动态过程的优化归结为求泛函的极值

求泛函极值的常用的方法为：变分法

离散动态过程的优化~动态规划模型



### 速降线与短程线

给定竖直平面内不再一条垂直线的两个点， A 和 B

求连接 A ， B 的光滑曲线，使质点在重力作用下沿该曲线以最短时间从 A 滑到 B

若沿直线段 AB 下滑，虽然路径短，但速度增长慢



建立坐标系 oxy ， A(0, 0) , B(x1, y1) ，曲线AB 为 y = y(x)

曲线弧长为 $ds=\sqrt{1+y'^2}dx$

质点在曲线 y(x) 上的速度 ds/dt

根据能量守恒，$1/2m(\frac{ds}{dt})^2=mgy$

故 $dt=\sqrt{\frac{1+y'^2}{2gy}}dx$

$J(y(x))=\int_0^{x_1}\sqrt{\frac{1+y'^2}{2gy}}dx$

故需要求 y(x) 使 J(y(x)) 达到最小，满足条件 y(0) = 0; y(x1)=y1



同样，若给定曲面上两个点， A 和 B ，求曲面上连接 A B 的最短曲线，建立坐标系，曲面方程 f(x, y, z) = 0

曲面上连接 A， B 的曲线， y=f(x), z=z(x)

曲线弧长 $ds=\sqrt{1+y'^2+z'^2}dx$

曲线长度 $J(y(x),z(x))=\int_{x_0}^{x_1}\sqrt{1+y'^2+z'^2}dx$

求 y = f(x) z = z(x) 使 J(y(x), z(x)) 最小



函数、函数的微分和极值

1. 对于 t 在某域的任一个值，有 y 的一个值与之对应，称 y 是 t 的函数，记作 y=f(t)
2. t 在 $t_0$ 的增量记作 $\Delta t=t-t_0$ ，微分 $dt=\Delta t$
3. y 在 $t_0$ 的增量记作 $\Delta f=f(t_0+\Delta t)-f(t_0)$ ， $\Delta f$ 的线性全部是函数的微分，记作 dy ， $dy=f'(t_0)dt$
4. 若函数 y 在域内 t 点打到极值，则在 t 点的微分 dy(t) = 0
5. y 在 t 的微分的另一表达式 $dy(t)=\frac{\partial}{\partial \alpha}f(t+\alpha \Delta t)| \alpha=0$



泛函、泛函的变分和极值

1. 对于某函数集合的每一个函数 x(t) ，有 J 的一个值与之对应，称 J 是 x(t) 的泛函，记作 J(x(t))
2. x(t) 在 $x_0(t)$ 的增量记作 $\delta x(t)=x(t)-x_0(t)$ ， $\delta x(t) $称 x(t) 的变分
3. 泛函 J(x(t)) 在 $x_0(t)$ 的增量记作 $\Delta J=J(x_0(t)+\delta x(t))-J(x_0(t))$ ， $\Delta J$ 的线性主部称泛函的变分，记作 $\delta J(x_0(t))$ 
4. 若泛函 J(x(t)) 在函数集合内的 x(t) 达到极值，则在 x(t) 的变分 $\delta J(x(t))=0$
5. 泛函 J(x(t)) 在 x(t) 的变分可以表示为 $\delta J(x(t)=\frac{\partial}{\partial \alpha}J(x(t)+\alpha \delta x(t)|\alpha=0$



故需要满足第 5 点要求时，泛函能取极值



欧拉方程

$F_x-F_{t \dot{x}}-F_{x \dot{x}} \dot{x}-F_{\dot{x} \dot{x}} \ddot{x}=0$

由于 $J(y(x))=\int_0^{x_1}\sqrt{\frac{1+y'^2}{2gy}}dx$ 满足欧拉方程，即 $F(y,y')=\sqrt{\frac{1+y'^2}{y}}$

故代入到欧拉方程为 $F_y-F_{xy'}-F_{yy'}y'-F_{y'y'}y''=0$

